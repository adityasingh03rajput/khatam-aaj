  <html>
<head>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-panel: #1E1E1E;
            --bg-element: #2D2D2D;
            --primary: #5D9CEC;
            --primary-light: #7EB0F1;
            --primary-dark: #4A8BD9;
            --text-primary: #E0E0E0;
            --text-secondary: #A0A0A0;
            --accent: #48C774;
            --border: #333333;
            --button-hover: #48C774;
            --error: #ff6b6b;
            --warning: #FFA500;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-dark);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        .app-title {
            color: var(--primary);
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 10px;
            font-weight: 700;
            letter-spacing: 1px;
        }
        
        .portal-title {
            color: var(--text-secondary);
            font-size: 1.2rem;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .portal-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 500px;
        }
            
        .auth-tabs-container {
            width: 100%;
            margin-bottom: 30px;
        }
        
        .auth-tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            gap: 10px;
        }
        
        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            font-size: 1.1rem;
            border-radius: 8px 8px 0 0;
            background-color: var(--bg-element);
            margin-bottom: -1px;
        }
        
        .auth-tab:hover {
            background-color: var(--bg-panel);
            color: var(--primary);
        }
        
        .auth-tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            font-weight: 600;
            background-color: var(--bg-panel);
        }
        
        .auth-container {
            background-color: var(--bg-panel);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            margin-top: 10px;
            width: 100%;
        }
        
        .auth-form {
            display: none;
            flex: 1;
            flex-direction: column;
            justify-content: center;
        }
        
        .auth-form.active {
            display: flex;
        }
        
        .form-content {
            width: 100%;
        }
        
        .form-group {
            margin-bottom: 20px;
            width: 100%;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(93, 156, 236, 0.3);
        }
        
        .remember-me {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        
        .remember-me input {
            width: auto;
            margin-right: 10px;
        }
        
        .remember-me label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .forgot-password {
            text-align: right;
            margin: 10px 0;
        }
        
        .forgot-password a {
            color: var(--primary);
            font-size: 0.9rem;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .forgot-password a:hover {
            color: var(--primary-light);
            text-decoration: underline;
        }
        
        .auth-button {
            width: 100%;
            padding: 12px;
            background-color: var(--primary);
            color: #ffffff;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .auth-button:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }
        
        .switch-text {
            text-align: center;
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .switch-text span {
            color: var(--primary);
            cursor: pointer;
            text-decoration: underline;
        }
        
        .switch-text span:hover {
            color: var(--primary-light);
        }
        
        .success-message {
            color: var(--accent);
            text-align: center;
            margin-top: 20px;
            font-size: 1rem;
            display: none;
        }
        
        .error-message {
            color: var(--error);
            text-align: center;
            margin-top: 5px;
            font-size: 0.9rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--bg-panel);
            padding: 30px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
        }
        
        .modal-title {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-close:hover {
            color: var(--text-primary);
        }
        
        .modal-button {
            width: 100%;
            padding: 10px;
            background-color: var(--primary);
            color: #ffffff;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .modal-button:hover {
            background-color: var(--button-hover);
        }
        
        #teacher-dashboard {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 900;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--text-primary);
        }
        
        .dashboard-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .dashboard-header h1 {
            color: var(--primary);
            font-size: 2.8rem;
            margin-bottom: 10px;
        }
        
        .dashboard-header p {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
        
        .dashboard-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            width: 80%;
            max-width: 900px;
        }
        
        .dashboard-option {
            background-color: var(--bg-panel);
            border-radius: 50%;
            width: 180px;
            height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--border);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .dashboard-option:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }
        
        .dashboard-option i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .dashboard-option span {
            font-size: 1.2rem;
            font-weight: 500;
            text-align: center;
        }

        .profile-btn {
            position: absolute;
            top: 30px;
            left: 30px;
            padding: 5px;
            background-color: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .profile-btn:hover {
            border-color: var(--primary);
        }

        .profile-btn img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        #timetable-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }
        
        .timetable-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            color: var(--text-primary);
        }
        
        .timetable-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .timetable-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }
        
        .timetable-actions {
            display: flex;
            gap: 15px;
        }
        
        .timetable-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .timetable-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }
        
        .timetable-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        
        .timetable-btn.secondary:hover {
            background-color: var(--bg-element);
        }
        
        .timetable-grid {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--bg-panel);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .timetable-grid th, 
        .timetable-grid td {
            border: 1px solid var(--border);
            padding: 12px;
            text-align: center;
        }
        
        .timetable-grid th {
            background-color: var(--bg-element);
            color: var(--primary);
            font-weight: 600;
        }
        
        .timetable-grid td {
            background-color: var(--bg-element);
            height: 60px;
            position: relative;
        }
        
        .timetable-grid td:hover {
            background-color: var(--bg-panel);
        }
        
        .time-edit {
            display: flex;
            gap: 5px;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
        }
        
        .time-edit input {
            width: 70px;
            padding: 5px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 3px;
            color: var(--text-primary);
        }
        
        .delete-period-btn {
            background: transparent;
            border: none;
            color: var(--error);
            cursor: pointer;
            margin-left: 5px;
        }
        
        .subject-input {
            width: 100%;
            padding: 8px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-size: 1rem;
            border-radius: 5px;
        }
        
        .subject-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .room-input {
            width: 100%;
            padding: 8px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-size: 0.9rem;
            border-radius: 5px;
            margin-top: 5px;
        }
        
        .break-cell {
            background-color: rgba(72, 199, 116, 0.1) !important;
            color: var(--accent);
            font-weight: 500;
        }
        
        .timetable-footer {
            margin-top: 30px;
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }
        
        .add-period-btn {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }

        .timetable-filters {
            background-color: var(--bg-panel);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .timetable-filter-group {
            flex: 1;
            min-width: 200px;
        }

        .timetable-filter-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .timetable-filter-group select {
            width: 100%;
            padding: 10px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

.attendance-filters {
    background-color: var(--bg-panel);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.attendance-filter-group {
    flex: 1;
    min-width: 200px;
}

.attendance-filter-group label {
    display: block;
    margin-bottom: 8px;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.attendance-filter-group select {
    width: 100%;
    padding: 10px;
    background-color: var(--bg-element);
    border: 1px solid var(--border);
    border-radius: 5px;
    color: var(--text-primary);
    font-size: 0.9rem;
}

/* Student Info Page */
#student-info-page {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--bg-dark);
    z-index: 1000;
    overflow-y: auto;
    padding: 40px 0;
}

        /* Attendance Dashboard Styles */
        #attendance-dashboard {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .attendance-container {
            width: 90%;
            max-width: 1000px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .attendance-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .attendance-actions {
            display: flex;
            gap: 15px;
        }

        .attendance-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .attendance-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .attendance-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .attendance-btn.secondary:hover {
            background-color: var(--bg-element);
        }

        .session-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .session-btn {
            padding: 12px 25px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .start-session {
            background-color: var(--accent);
            color: white;
            border: none;
        }

        .start-session:hover {
            background-color: #3aa35c;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(72, 199, 116, 0.3);
        }

        .manual-btn {
            background-color: var(--primary-dark);
            color: white;
            border: none;
        }

        .manual-btn:hover {
            background-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(93, 156, 236, 0.3);
        }

        .random-ring-btn {
            background-color: var(--warning);
            color: white;
            border: none;
        }

        .random-ring-btn:hover {
            background-color: #e69500;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 165, 0, 0.3);
        }

        .students-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--bg-panel);
            border-radius: 10px;
            overflow: hidden;
        }

        .students-table th {
            background-color: var(--bg-element);
            color: var(--primary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .students-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .students-table tr:last-child td {
            border-bottom: none;
        }

        .students-table tr:hover {
            background-color: var(--bg-element);
        }

        .status-present {
            color: var(--accent);
        }

        .status-absent {
            color: var(--error);
        }

        .status-pending {
            color: var(--text-secondary);
        }

        .status-verifying {
            color: var(--warning);
        }

        .timer {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }

        /* Random Ring Modal */
        #random-ring-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }

        .random-ring-content {
            background-color: var(--bg-panel);
            padding: 30px;
            border-radius: 10px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
        }

        .random-ring-title {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }

        .random-ring-form {
            margin-bottom: 20px;
        }

        .random-ring-form label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .random-ring-form input {
            width: 100%;
            padding: 10px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
        }

        .random-ring-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .cancel-random-ring-btn {
            background-color: var(--bg-element);
            color: var(--text-primary);
            border: 1px solid var(--border);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .cancel-random-ring-btn:hover {
            background-color: var(--bg-panel);
        }

        .start-random-ring-btn {
            background-color: var(--warning);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }

        .start-random-ring-btn:hover {
            background-color: #e69500;
        }

        /* Student Verification Modal */
        #student-verification-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }

        .student-verification-content {
            background-color: var(--bg-panel);
            padding: 30px;
            border-radius: 10px;
            width: 600px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
        }

        .student-verification-title {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }

        .verification-student-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .verification-student-name {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .verification-student-id {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .verification-face-container {
            width: 300px;
            height: 300px;
            margin: 0 auto 20px;
            background-color: var(--bg-element);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .verification-face-placeholder {
            font-size: 5rem;
            color: var(--text-secondary);
        }

        .verification-face-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .verification-status {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: var(--warning);
        }

        .verification-timer {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 20px;
            color: var(--warning);
        }

        .verification-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .verification-btn {
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            border: none;
        }

        .verification-success-btn {
            background-color: var(--accent);
            color: white;
        }

        .verification-success-btn:hover {
            background-color: #3aa35c;
        }

        .verification-fail-btn {
            background-color: var(--error);
            color: white;
        }

        .verification-fail-btn:hover {
            background-color: #e05555;
        }

        /* Manual Attendance Page */
        #manual-attendance-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .manual-attendance-container {
            width: 90%;
            max-width: 1000px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .manual-attendance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .manual-attendance-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(93, 156, 236, 0.3);
        }

        .manual-students-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--bg-panel);
            border-radius: 10px;
            overflow: hidden;
        }

        .manual-students-table th {
            background-color: var(--bg-element);
            color: var(--primary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .manual-students-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .manual-students-table tr:last-child td {
            border-bottom: none;
        }

        .manual-students-table tr:hover {
            background-color: var(--bg-element);
        }

        .toggle-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--error);
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--accent);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .toggle-label {
            font-size: 0.9rem;
        }

        /* Action buttons for manual attendance */
        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .present-btn, .absent-btn {
            padding: 5px 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .present-btn {
            background-color: var(--accent);
            color: white;
        }

        .absent-btn {
            background-color: var(--error);
            color: white;
        }

        .present-btn:hover {
            background-color: #3aa35c;
        }

        .absent-btn:hover {
            background-color: #e05555;
        }

        /* Student Management Page */
        #student-management-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .student-management-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .student-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .student-management-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .student-management-actions {
            display: flex;
            gap: 15px;
        }

        .student-management-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .student-management-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .student-management-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .student-management-btn.secondary:hover {
            background-color: var(--bg-element);
        }

        .student-form-container {
            background-color: var(--bg-panel);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }

        .student-form-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-col {
            flex: 1;
            min-width: 250px;
        }

        .form-group select {
            width: 100%;
            padding: 12px 15px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(93, 156, 236, 0.3);
        }

        /* Reports Page */
        #reports-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .reports-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .reports-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .reports-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .reports-actions {
            display: flex;
            gap: 15px;
        }

        .reports-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .reports-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .reports-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .reports-btn.secondary:hover {
            background-color: var(--bg-element);
        }

        .filter-container {
            background-color: var(--bg-panel);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }

        .filter-title {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 20px;
        }

        .date-range-container {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .date-range-group {
            flex: 1;
            min-width: 200px;
        }

        .date-range-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .date-range-input {
            width: 100%;
            padding: 10px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .student-reports-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--bg-panel);
            border-radius: 10px;
            overflow: hidden;
        }

        .student-reports-table th {
            background-color: var(--bg-element);
            color: var(--primary);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .student-reports-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
        }

        .student-reports-table tr:last-child td {
            border-bottom: none;
        }

        .student-reports-table tr:hover {
            background-color: var(--bg-element);
        }

        .attendance-details {
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .attendance-percentage {
            font-weight: bold;
            color: var(--accent);
        }

        .attendance-date {
            display: inline-block;
            margin-right: 10px;
            margin-bottom: 5px;
            padding: 3px 8px;
            background-color: var(--bg-element);
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .present-date {
            color: var(--accent);
            border: 1px solid var(--accent);
        }

        .absent-date {
            color: var(--error);
            border: 1px solid var(--error);
        }

        .progress-bar {
            height: 10px;
            background-color: var(--bg-element);
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: var(--accent);
            border-radius: 5px;
        }

        .action-btn {
            padding: 5px 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
            margin-right: 5px;
        }

        .view-btn {
            background-color: var(--primary);
            color: white;
        }

        .view-btn:hover {
            background-color: var(--primary-dark);
        }
        
        /* BSSID Page */
        #bssid-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .bssid-container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .bssid-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .bssid-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .bssid-actions {
            display: flex;
            gap: 15px;
        }

        .bssid-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .bssid-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .bssid-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .bssid-btn.secondary:hover {
            background-color: var(--bg-element);
        }

        /* Location Group Styles */
        .location-group {
            background-color: var(--bg-panel);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
        }

        .location-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .location-name {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--primary);
        }

        .location-actions {
            display: flex;
            gap: 10px;
        }

        .location-btn {
            padding: 5px 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .add-bssid-btn {
            background-color: var(--accent);
            color: white;
        }

        .add-bssid-btn:hover {
            background-color: #3aa35c;
        }

        .delete-location-btn {
            background-color: var(--error);
            color: white;
        }

        .delete-location-btn:hover {
            background-color: #e05555;
        }

        .bssid-list {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .bssid-list th {
            background-color: var(--bg-element);
            color: var(--primary);
            padding: 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .bssid-list td {
            padding: 8px 10px;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }

        .bssid-list tr:last-child td {
            border-bottom: none;
        }

        .bssid-list tr:hover {
            background-color: var(--bg-element);
        }

        .bssid-status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .status-active {
            background-color: rgba(72, 199, 116, 0.2);
            color: var(--accent);
            border: 1px solid var(--accent);
        }

        .status-inactive {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--error);
            border: 1px solid var(--error);
        }

        /* Profile Page */
        #profile-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .profile-container {
            width: 90%;
            max-width: 800px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .profile-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .profile-actions {
            display: flex;
            gap: 15px;
        }

        .profile-btn-secondary {
            padding: 10px 20px;
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .profile-btn-secondary:hover {
            background-color: var(--bg-element);
        }

        .profile-content {
            background-color: var(--bg-panel);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
        }

        .profile-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .profile-picture {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary);
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-picture:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(93, 156, 236, 0.5);
        }

        .profile-name {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .profile-email {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .profile-details {
            width: 100%;
        }

        .profile-detail {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid var(--border);
        }

        .profile-detail:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: var(--text-secondary);
        }

        .detail-value {
            font-weight: 500;
        }

        .profile-actions-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .profile-action-btn {
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .change-password-btn {
            background-color: var(--primary);
            color: white;
            border: none;
        }

        .change-password-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .logout-profile-btn {
            background-color: var(--error);
            color: white;
            border: none;
        }

        .logout-profile-btn:hover {
            background-color: #e05555;
            transform: translateY(-2px);
        }

        /* File Input for Profile Picture */
        .file-input-container {
            position: relative;
            display: inline-block;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        /* Change Password Modal */
        #change-password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }

        .change-password-content {
            background-color: var(--bg-panel);
            padding: 30px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
        }

        .change-password-title {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }

        .password-input-group {
            margin-bottom: 20px;
        }

        .password-input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }

        .password-input-group input {
            width: 100%;
            padding: 10px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
        }

        .password-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .cancel-password-btn {
            background-color: var(--bg-element);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .cancel-password-btn:hover {
            background-color: var(--bg-panel);
        }

        .save-password-btn {
            background-color: var(--accent);
            color: white;
        }

        .save-password-btn:hover {
            background-color: #3aa35c;
        }

        /* Edit BSSID Modal */
        #edit-bssid-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }

        .edit-bssid-content {
            background-color: var(--bg-panel);
            padding: 30px;
            border-radius: 10px;
            width: 400px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
        }

        .edit-bssid-title {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-align: center;
        }

        /* Notice Page Styles */
        #notice-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-dark);
            z-index: 1000;
            overflow-y: auto;
            padding: 40px 0;
        }

        .notice-container {
            width: 90%;
            max-width: 1000px;
            margin: 0 auto;
            color: var(--text-primary);
        }

        .notice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .notice-title {
            color: var(--primary);
            font-size: 2.5rem;
            margin: 0;
        }

        .notice-actions {
            display: flex;
            gap: 15px;
        }

        .notice-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .notice-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }

        .notice-btn.secondary {
            background-color: var(--bg-panel);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .notice-btn.secondary:hover {
            background-color: var(--bg-element);
        }

        .notice-filters {
            background-color: var(--bg-panel);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .notice-filter-group {
            flex: 1;
            min-width: 200px;
        }

        .notice-filter-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .notice-filter-group select {
            width: 100%;
            padding: 10px;
            background-color: var(--bg-element);
            border: 1px solid var(--border);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .notices-list {
            margin-top: 20px;
        }

        .notice-card {
            background-color: var(--bg-panel);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
        }

        .notice-card.important {
            border-left: 4px solid var(--error);
        }

        .notice-card.urgent {
            border-left: 4px solid var(--warning);
        }

        .notice-card.holiday {
            border-left: 4px solid var(--accent);
        }

        .notice-card.exam {
            border-left: 4px solid var(--primary);
        }

        .notice-card.event {
            border-left: 4px solid #9b59b6;
        }

        .notice-heading {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }

        .notice-type {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .type-general {
            background-color: rgba(93, 156, 236, 0.2);
            color: var(--primary);
        }

        .type-holiday {
            background-color: rgba(72, 199, 116, 0.2);
            color: var(--accent);
        }

        .type-exam {
            background-color: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
        }

        .type-event {
            background-color: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
        }

        .type-urgent {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--error);
        }

        .notice-meta {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .notice-department {
            font-weight: 500;
        }

        .notice-date {
            font-style: italic;
        }

        .notice-content {
            margin-bottom: 15px;
            line-height: 1.6;
            white-space: pre-line;
        }

        .notice-attachments {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }

        .attachment-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .attachment-icon {
            margin-right: 10px;
            color: var(--primary);
        }

        .attachment-name {
            color: var(--primary-light);
            text-decoration: none;
            transition: color 0.2s;
        }

        .attachment-name:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        .notice-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
        }

        .delete-notice-btn {
            background-color: var(--bg-element);
            color: var(--error);
            border: 1px solid var(--error);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .delete-notice-btn:hover {
            background-color: rgba(255, 107, 107, 0.1);
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Teacher Portal (now the main page) -->
    <div class="portal-container">
        <h1 class="app-title">Let's Bunk</h1>
        <div class="portal-title">Teacher Portal</div>
        
        <div class="auth-tabs-container">
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login', 'teacher')">Login</div>
                <div class="auth-tab" onclick="switchAuthTab('signup', 'teacher')">Sign Up</div>
            </div>
        </div>
        
        <div class="auth-container">
            <div id="teacher-login-form" class="auth-form active">
                <div class="form-content">
                    <div class="form-group">
                        <label for="teacher-login-email">Email</label>
                        <input type="email" id="teacher-login-email" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="teacher-login-password">Password</label>
                        <input type="password" id="teacher-login-password" placeholder="Enter your password">
                    </div>
                    <div class="remember-me">
                        <input type="checkbox" id="teacher-remember-me">
                        <label for="teacher-remember-me">Remember me</label>
                    </div>
                    <div class="forgot-password">
                        <a href="#" onclick="showForgotPasswordModal('teacher')">Forgot password?</a>
                    </div>
                </div>
                <div>
                    <button class="auth-button" onclick="login('teacher')">Login</button>
                    <div class="success-message" id="teacher-login-success"></div>
                    <div class="switch-text">
                        Don't have an account? <span onclick="switchAuthTab('signup', 'teacher')">Sign up</span>
                    </div>
                </div>
            </div>
            
            <div id="teacher-signup-form" class="auth-form">
                <div class="form-content">
                    <div class="form-group">
                        <label for="teacher-signup-name">Full Name</label>
                        <input type="text" id="teacher-signup-name" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="teacher-signup-email">Email</label>
                        <input type="email" id="teacher-signup-email" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label for="teacher-signup-password">Password</label>
                        <input type="password" id="teacher-signup-password" placeholder="Create a password">
                    </div>
                    <div class="form-group">
                        <label for="teacher-signup-confirm">Confirm Password</label>
                        <input type="password" id="teacher-signup-confirm" placeholder="Confirm your password">
                    </div>
                    <div class="remember-me">
                        <input type="checkbox" id="teacher-remember-me-signup">
                        <label for="teacher-remember-me-signup">Remember me</label>
                    </div>
                </div>
                <div>
                    <button class="auth-button" onclick="signup('teacher')">Create Account</button>
                    <div class="success-message" id="teacher-signup-success"></div>
                    <div class="switch-text">
                        Already have an account? <span onclick="switchAuthTab('login', 'teacher')">Login</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Teacher Dashboard -->
    <div class="new-page" id="teacher-dashboard">
        <button class="profile-btn" onclick="openProfilePage()" id="profile-btn">
            <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Profile" id="profile-img">
        </button>
        
        <div class="dashboard-header">
            <h1>Teacher Dashboard</h1>
            <p>Welcome back! What would you like to do today?</p>
        </div>
        
        <div class="dashboard-options">
            <div class="dashboard-option" onclick="openAttendanceDashboard()">
                <i class="fas fa-clipboard-check"></i>
                <span>Attendance</span>
            </div>
            <div class="dashboard-option" onclick="openTimetablePage()">
                <i class="fas fa-calendar-alt"></i>
                <span>Timetable</span>
            </div>
            <div class="dashboard-option" onclick="openStudentManagementPage()">
                <i class="fas fa-users"></i>
                <span>Student Management</span>
            </div>
            <div class="dashboard-option" onclick="openReportsPage()">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </div>
            <div class="dashboard-option" onclick="openBSSIDPage()">
                <i class="fas fa-wifi"></i>
                <span>BSSID</span>
            </div>
            <div class="dashboard-option" onclick="openNoticePage()">
                <i class="fas fa-bell"></i>
                <span>Notices</span>
            </div>
        </div>
    </div>
    
    <!-- Timetable Page -->
    <div class="new-page" id="timetable-page">
        <div class="timetable-container">
            <div class="timetable-header">
                <h1 class="timetable-title">College Timetable</h1>
                <div class="timetable-actions">
                    <button class="timetable-btn secondary" onclick="closeTimetablePage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>
            </div>
            
            <div class="timetable-filters">
                <div class="timetable-filter-group">
                    <label for="timetable-semester">Semester</label>
                    <select id="timetable-semester" onchange="filterTimetable()">
                        <option value="">All Semesters</option>
                        <option value="1">1st Semester</option>
                        <option value="2">2nd Semester</option>
                        <option value="3">3rd Semester</option>
                        <option value="4">4th Semester</option>
                        <option value="5">5th Semester</option>
                        <option value="6">6th Semester</option>
                        <option value="7">7th Semester</option>
                        <option value="8">8th Semester</option>
                    </select>
                </div>
                <div class="timetable-filter-group">
                    <label for="timetable-branch">Branch</label>
                    <select id="timetable-branch" onchange="filterTimetable()">
                        <option value="">All Branches</option>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="CE">Civil</option>
                        <option value="EE">Electrical</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
            </div>
            
            <div class="add-period-btn">
                <button class="timetable-btn" onclick="addNewPeriod()">
                    <i class="fas fa-plus"></i> Add New Period
                </button>
            </div>
            
            <table class="timetable-grid">
                <thead>
                    <tr>
                        <th>Time/Day</th>
                        <th>Monday</th>
                        <th>Tuesday</th>
                        <th>Wednesday</th>
                        <th>Thursday</th>
                        <th>Friday</th>
                        <th>Saturday</th>
                    </tr>
                </thead>
                <tbody id="timetable-body">
                    <!-- Timetable rows will be added here dynamically -->
                </tbody>
            </table>
            
            <div class="timetable-footer">
                <button class="timetable-btn secondary" onclick="addBreakToAllDays()">
                    Add Break to All Days
                </button>
                <button class="timetable-btn" onclick="saveTimetable()">
                    <i class="fas fa-save"></i> Save Timetable
                </button>
            </div>
        </div>
    </div>

    <!-- Attendance Dashboard -->
    <div class="new-page" id="attendance-dashboard">
        <div class="attendance-container">
            <div class="attendance-header">
                <h1 class="attendance-title">Attendance Management</h1>
                <div class="attendance-actions">
                    <button class="attendance-btn secondary" onclick="closeAttendanceDashboard()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>
            </div>

<div class="attendance-filters">
    <div class="attendance-filter-group">
        <label for="attendance-semester">Semester</label>
        <select id="attendance-semester">
            <option value="">All Semesters</option>
            <option value="1">1st Semester</option>
            <option value="2">2nd Semester</option>
            <option value="3">3rd Semester</option>
            <option value="4">4th Semester</option>
            <option value="5">5th Semester</option>
            <option value="6">6th Semester</option>
            <option value="7">7th Semester</option>
            <option value="8">8th Semester</option>
        </select>
    </div>
    <div class="attendance-filter-group">
        <label for="attendance-branch">Branch</label>
        <select id="attendance-branch">
            <option value="">All Branches</option>
            <option value="CSE">Computer Science</option>
            <option value="ECE">Electronics</option>
            <option value="ME">Mechanical</option>
            <option value="CE">Civil</option>
            <option value="EE">Electrical</option>
            <option value="IT">Information Technology</option>
        </select>
    </div>
    <div class="attendance-filter-group">
        <label for="attendance-classroom">Classroom</label>
        <select id="attendance-classroom">
            <option value="">All Classrooms</option>
            <option value="A101">A101</option>
            <option value="A102">A102</option>
            <option value="B201">B201</option>
            <option value="B202">B202</option>
            <option value="C301">C301</option>
        </select>
    </div>
    <div class="attendance-filter-group">
        <button class="attendance-btn" onclick="applyAttendanceFilters()">
            <i class="fas fa-filter"></i> Apply Filters
        </button>
    </div>
</div>

<div class="session-controls">
    <button class="session-btn start-session" onclick="startAttendanceSession()" id="start-session-btn">
        <i class="fas fa-play"></i> Start Session
    </button>
    <button class="session-btn end-session" onclick="endAttendanceSession()" id="end-session-btn" disabled>
        <i class="fas fa-stop"></i> End Session
    </button>
    <button class="session-btn manage-session" onclick="showManageSessionsModal()">
        <i class="fas fa-cog"></i> Manage Sessions
    </button>
    <button class="session-btn manual-btn" onclick="openManualAttendancePage()">
        <i class="fas fa-edit"></i> Manual Attendance
    </button>
    <button class="session-btn random-ring-btn" onclick="showRandomRingModal()">
        <i class="fas fa-random"></i> Random Ring
    </button>
</div>

            <table class="students-table">
                <thead>
                    <tr>
                        <th>Student ID</th>
                        <th>Name</th>
                        <th>Timer</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="students-list">
                    <!-- Student data will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Random Ring Modal -->
    <div class="modal" id="random-ring-modal">
        <div class="random-ring-content">
            <span class="modal-close" onclick="hideRandomRingModal()">&times;</span>
            <h3 class="random-ring-title">Random Ring Verification</h3>
            
            <div class="random-ring-form">
                <label for="random-ring-count">Number of Students to Verify</label>
                <input type="number" id="random-ring-count" min="1" max="10" value="3" placeholder="Enter number of students">
            </div>
            
            <div class="random-ring-actions">
                <button class="cancel-random-ring-btn" onclick="hideRandomRingModal()">Cancel</button>
                <button class="start-random-ring-btn" onclick="startRandomRing()">Start Verification</button>
            </div>
        </div>
    </div>

    <!-- Student Verification Modal -->
    <div class="modal" id="student-verification-modal">
        <div class="student-verification-content">
            <span class="modal-close" onclick="hideStudentVerificationModal()">&times;</span>
            <h3 class="student-verification-title">Student Verification</h3>
            
            <div class="verification-student-info">
                <div class="verification-student-name" id="verification-student-name">Student Name</div>
                <div class="verification-student-id" id="verification-student-id">ID: ST001</div>
            </div>
            
            <div class="verification-face-container">
                <div class="verification-face-placeholder">
                    <i class="fas fa-user"></i>
                </div>
                <img src="" class="verification-face-image" id="verification-face-image">
            </div>
            
            <div class="verification-status" id="verification-status">
                Please verify your identity using facial recognition
            </div>
            
            <div class="verification-timer" id="verification-timer">
                00:30
            </div>
            
            <div class="verification-actions">
                <button class="verification-btn verification-success-btn" onclick="verifyStudentSuccess()">
                    <i class="fas fa-check"></i> Verified
                </button>
                <button class="verification-btn verification-fail-btn" onclick="verifyStudentFail()">
                    <i class="fas fa-times"></i> Not Verified
                </button>
            </div>
        </div>
    </div>

    <!-- Manual Attendance Page -->
    <div class="new-page" id="manual-attendance-page">
        <div class="manual-attendance-container">
            <div class="manual-attendance-header">
                <h1 class="manual-attendance-title">Manual Attendance</h1>
                <div class="attendance-actions">
                    <button class="attendance-btn secondary" onclick="closeManualAttendancePage()">
                        <i class="fas fa-arrow-left"></i> Back to Attendance
                    </button>
                </div>
            </div>

            <div class="search-container">
                <input type="text" class="search-input" id="student-search" placeholder="Search for students..." oninput="searchStudents()">
            </div>

            <table class="manual-students-table">
                <thead>
                    <tr>
                        <th>Student ID</th>
                        <th>Name</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="manual-students-list">
                    <!-- Student data will be populated here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Student Management Page -->
    <div class="new-page" id="student-management-page">
        <div class="student-management-container">
            <div class="student-management-header">
                <h1 class="student-management-title">Student Management</h1>
                <div class="student-management-actions">
                    <button class="student-management-btn secondary" onclick="closeStudentManagementPage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <button class="student-management-btn" onclick="openStudentInfoPage()">
                        <i class="fas fa-info-circle"></i> Student Info
                    </button>
                </div>
            </div>

            <div class="student-form-container">
                <h2 class="student-form-title">Create New Student</h2>
                <form id="student-form">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-id">Student ID</label>
                                <input type="text" id="student-id" placeholder="Enter student ID" required>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-name">Full Name</label>
                                <input type="text" id="student-name" placeholder="Enter full name" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-email">Email</label>
                                <input type="email" id="student-email" placeholder="Enter email address" required>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-password">Password</label>
                                <input type="password" id="student-password" placeholder="Create password" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-semester">Semester</label>
                                <select id="student-semester" required>
                                    <option value="">Select Semester</option>
                                    <option value="1">1st Semester</option>
                                    <option value="2">2nd Semester</option>
                                    <option value="3">3rd Semester</option>
                                    <option value="4">4th Semester</option>
                                    <option value="5">5th Semester</option>
                                    <option value="6">6th Semester</option>
                                    <option value="7">7th Semester</option>
                                    <option value="8">8th Semester</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="student-branch">Branch</label>
                                <select id="student-branch" required>
                                    <option value="">Select Branch</option>
                                    <option value="CSE">Computer Science</option>
                                    <option value="ECE">Electronics</option>
                                    <option value="ME">Mechanical</option>
                                    <option value="CE">Civil</option>
                                    <option value="EE">Electrical</option>
                                    <option value="IT">Information Technology</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <button type="submit" class="student-management-btn">
                                <i class="fas fa-user-plus"></i> Create Student
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

<!-- Student Info Page -->
<div class="new-page" id="student-info-page">
    <div class="student-management-container">
        <div class="student-management-header">
            <h1 class="student-management-title">Student Information</h1>
            <div class="student-management-actions">
                <button class="student-management-btn secondary" onclick="closeStudentInfoPage()">
                    <i class="fas fa-arrow-left"></i> Back to Student Management
                </button>
            </div>
        </div>

        <div class="timetable-filters">
            <div class="timetable-filter-group">
                <label for="student-info-semester">Semester</label>
                <select id="student-info-semester">
                    <option value="">All Semesters</option>
                    <option value="1">1st Semester</option>
                    <option value="2">2nd Semester</option>
                    <option value="3">3rd Semester</option>
                    <option value="4">4th Semester</option>
                    <option value="5">5th Semester</option>
                    <option value="6">6th Semester</option>
                    <option value="7">7th Semester</option>
                    <option value="8">8th Semester</option>
                </select>
            </div>
            <div class="timetable-filter-group">
                <label for="student-info-branch">Branch</label>
                <select id="student-info-branch">
                    <option value="">All Branches</option>
                    <option value="CSE">Computer Science</option>
                    <option value="ECE">Electronics</option>
                    <option value="ME">Mechanical</option>
                    <option value="CE">Civil</option>
                    <option value="EE">Electrical</option>
                    <option value="IT">Information Technology</option>
                </select>
            </div>
            <div class="timetable-filter-group">
                <label>&nbsp;</label>
                <button class="student-management-btn" onclick="filterStudents()">
                    <i class="fas fa-search"></i> Search
                </button>
            </div>
        </div>

        <table class="students-table">
            <thead>
                <tr>
                    <th>Student ID</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Semester</th>
                    <th>Branch</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="student-info-list">
                <!-- Student data will be populated here -->
            </tbody>
        </table>
    </div>
</div>

<!-- Edit Student Modal -->
<div class="modal" id="edit-student-modal">
    <div class="modal-content" style="width: 500px;">
        <span class="modal-close" onclick="hideEditStudentModal()">&times;</span>
        <h3 class="modal-title">Edit Student Information</h3>
        
        <div class="form-group">
            <label for="edit-student-id">Student ID</label>
            <input type="text" id="edit-student-id" readonly>
        </div>
        
        <div class="form-group">
            <label for="edit-student-name">Full Name</label>
            <input type="text" id="edit-student-name" required>
        </div>
        
        <div class="form-group">
            <label for="edit-student-email">Email</label>
            <input type="email" id="edit-student-email" required>
        </div>
        
        <div class="form-group">
            <label for="edit-student-password">Password (leave blank to keep current)</label>
            <input type="password" id="edit-student-password">
        </div>
        
        <div class="form-row">
            <div class="form-col">
                <div class="form-group">
                    <label for="edit-student-semester">Semester</label>
                    <select id="edit-student-semester" required>
                        <option value="1">1st Semester</option>
                        <option value="2">2nd Semester</option>
                        <option value="3">3rd Semester</option>
                        <option value="4">4th Semester</option>
                        <option value="5">5th Semester</option>
                        <option value="6">6th Semester</option>
                        <option value="7">7th Semester</option>
                        <option value="8">8th Semester</option>
                    </select>
                </div>
            </div>
            <div class="form-col">
                <div class="form-group">
                    <label for="edit-student-branch">Branch</label>
                    <select id="edit-student-branch" required>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="CE">Civil</option>
                        <option value="EE">Electrical</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
            </div>
        </div>
        
        <button class="modal-button" onclick="saveStudentChanges()">Save Changes</button>
    </div>
</div>

    <!-- Reports Page -->
    <div class="new-page" id="reports-page">
        <div class="reports-container">
            <div class="reports-header">
                <h1 class="reports-title">Attendance Reports</h1>
                <div class="reports-actions">
                    <button class="reports-btn secondary" onclick="closeReportsPage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>
            </div>

            <div class="filter-container">
                <h2 class="filter-title">Filter Students</h2>
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label for="report-semester">Semester</label>
                            <select id="report-semester">
                                <option value="">All Semesters</option>
                                <option value="1">1st Semester</option>
                                <option value="2">2nd Semester</option>
                                <option value="3">3rd Semester</option>
                                <option value="4">4th Semester</option>
                                <option value="5">5th Semester</option>
                                <option value="6">6th Semester</option>
                                <option value="7">7th Semester</option>
                                <option value="8">8th Semester</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="form-group">
                            <label for="report-branch">Branch</label>
                            <select id="report-branch">
                                <option value="">All Branches</option>
                                <option value="CSE">Computer Science</option>
                                <option value="ECE">Electronics</option>
                                <option value="ME">Mechanical</option>
                                <option value="CE">Civil</option>
                                <option value="EE">Electrical</option>
                                <option value="IT">Information Technology</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="date-range-container">
                    <div class="date-range-group">
                        <label class="date-range-label" for="report-start-date">From Date</label>
                        <input type="date" id="report-start-date" class="date-range-input">
                    </div>
                    <div class="date-range-group">
                        <label class="date-range-label" for="report-end-date">To Date</label>
                        <input type="date" id="report-end-date" class="date-range-input">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button class="reports-btn" onclick="generateReports()">
                                <i class="fas fa-search"></i> Generate Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <table class="student-reports-table">
                <thead>
                    <tr>
                        <th>Student ID</th>
                        <th>Name</th>
                        <th>Semester</th>
                        <th>Branch</th>
                        <th>Attendance</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="reports-body">
                    <!-- Reports will be populated here -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- BSSID Page -->
    <div class="new-page" id="bssid-page">
        <div class="bssid-container">
            <div class="bssid-header">
                <h1 class="bssid-title">BSSID Management</h1>
                <div class="bssid-actions">
                    <button class="bssid-btn secondary" onclick="closeBSSIDPage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <button class="bssid-btn" onclick="showAddLocationModal()">
                        <i class="fas fa-plus"></i> Add New Location
                    </button>
                </div>
            </div>
            
            <div id="bssid-locations-container">
                <!-- Location groups will be added here dynamically -->
            </div>
        </div>
    </div>
    
    <!-- Notice Page -->
    <div class="new-page" id="notice-page">
        <div class="notice-container">
            <div class="notice-header">
                <h1 class="notice-title">Notice Management</h1>
                <div class="notice-actions">
                    <button class="notice-btn secondary" onclick="closeNoticePage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                    <button class="notice-btn" onclick="showAddNoticeModal()">
                        <i class="fas fa-plus"></i> Add New Notice
                    </button>
                </div>
            </div>
            
            <div class="notice-filters">
                <div class="notice-filter-group">
                    <label for="notice-semester">Semester</label>
                    <select id="notice-semester" onchange="filterNotices()">
                        <option value="">All Semesters</option>
                        <option value="1">1st Semester</option>
                        <option value="2">2nd Semester</option>
                        <option value="3">3rd Semester</option>
                        <option value="4">4th Semester</option>
                        <option value="5">5th Semester</option>
                        <option value="6">6th Semester</option>
                        <option value="7">7th Semester</option>
                        <option value="8">8th Semester</option>
                    </select>
                </div>
                <div class="notice-filter-group">
                    <label for="notice-branch">Branch</label>
                    <select id="notice-branch" onchange="filterNotices()">
                        <option value="">All Branches</option>
                        <option value="CSE">Computer Science</option>
                        <option value="ECE">Electronics</option>
                        <option value="ME">Mechanical</option>
                        <option value="CE">Civil</option>
                        <option value="EE">Electrical</option>
                        <option value="IT">Information Technology</option>
                    </select>
                </div>
                <div class="notice-filter-group">
                    <label for="notice-type">Notice Type</label>
                    <select id="notice-type" onchange="filterNotices()">
                        <option value="">All Types</option>
                        <option value="holiday">Holiday</option>
                        <option value="exam">Exam</option>
                        <option value="event">Event</option>
                        <option value="general">General</option>
                        <option value="urgent">Urgent</option>
                    </select>
                </div>
            </div>
            
            <div class="notices-list" id="notices-list">
                <!-- Notices will be populated here -->
            </div>
        </div>
    </div>
    
    <!-- Add Notice Modal -->
    <div class="modal" id="add-notice-modal">
        <div class="modal-content" style="width: 600px;">
            <span class="modal-close" onclick="hideAddNoticeModal()">&times;</span>
            <h3 class="modal-title">Create New Notice</h3>
            
            <div class="form-group">
                <label for="notice-heading">Heading</label>
                <input type="text" id="notice-heading" placeholder="Enter notice heading" required>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="notice-semester-select">Semester</label>
                        <select id="notice-semester-select" multiple size="4">
                            <option value="all">All Semesters</option>
                            <option value="1">1st Semester</option>
                            <option value="2">2nd Semester</option>
                            <option value="3">3rd Semester</option>
                            <option value="4">4th Semester</option>
                            <option value="5">5th Semester</option>
                            <option value="6">6th Semester</option>
                            <option value="7">7th Semester</option>
                            <option value="8">8th Semester</option>
                        </select>
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="notice-branch-select">Branch</label>
                        <select id="notice-branch-select" multiple size="4">
                            <option value="all">All Branches</option>
                            <option value="CSE">Computer Science</option>
                            <option value="ECE">Electronics</option>
                            <option value="ME">Mechanical</option>
                            <option value="CE">Civil</option>
                            <option value="EE">Electrical</option>
                            <option value="IT">Information Technology</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="notice-type-select">Notice Type</label>
                        <select id="notice-type-select" required>
                            <option value="general">General</option>
                            <option value="holiday">Holiday</option>
                            <option value="exam">Exam</option>
                            <option value="event">Event</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="notice-department">Department</label>
                        <input type="text" id="notice-department" placeholder="e.g., Computer Science" value="Computer Science">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="notice-content">Notice Content</label>
                <textarea id="notice-content" rows="5" placeholder="Write notice details here..." required></textarea>
            </div>
            
            <div class="form-group">
                <label for="notice-important">
                    <input type="checkbox" id="notice-important"> Important Notice
                </label>
            </div>
            
            <div class="form-group">
                <label for="notice-files">Attach Files (if any)</label>
                <input type="file" id="notice-files" multiple>
            </div>
            
            <button class="modal-button" onclick="saveNotice()">Publish Notice</button>
        </div>
    </div>

    <!-- Profile Page -->
    <div class="new-page" id="profile-page">
        <div class="profile-container">
            <div class="profile-header">
                <h1 class="profile-title">My Profile</h1>
                <div class="profile-actions">
                    <button class="profile-btn-secondary" onclick="closeProfilePage()">
                        <i class="fas fa-arrow-left"></i> Back to Dashboard
                    </button>
                </div>
            </div>
            
            <div class="profile-content">
                <div class="profile-info">
                    <div class="file-input-container">
                        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Profile Picture" class="profile-picture" id="profile-picture">
                        <input type="file" id="profile-upload" class="file-input" accept="image/*" onchange="handleProfilePictureUpload(event)">
                    </div>
                    <h2 class="profile-name" id="profile-name">Animesh</h2>
                    <p class="profile-email" id="profile-email">john.doe@example.com</p>
                </div>
                
                <div class="profile-details">
                    <div class="profile-detail">
                        <span class="detail-label">Teacher ID:</span>
                        <span class="detail-value" id="profile-id">T001</span>
                    </div>
                    <div class="profile-detail">
                        <span class="detail-label">Department:</span>
                        <span class="detail-value" id="profile-department">Computer Science</span>
                    </div>
                    <div class="profile-detail">
                        <span class="detail-label">Last Login:</span>
                        <span class="detail-value" id="profile-last-login">Today, 10:30 AM</span>
                    </div>
                    <div class="profile-detail">
                        <span class="detail-label">Account Created:</span>
                        <span class="detail-value" id="profile-created">January 15, 2023</span>
                    </div>
                </div>
                
                <div class="profile-actions-container">
                    <button class="profile-action-btn change-password-btn" onclick="showChangePasswordModal()">
                        <i class="fas fa-key"></i> Change Password
                    </button>
                    <button class="profile-action-btn logout-profile-btn" onclick="logoutTeacher()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Forgot Password Modal -->
    <div class="modal" id="forgot-password-modal">
        <div class="modal-content">
            <span class="modal-close" onclick="hideForgotPasswordModal()">&times;</span>
            <h3 class="modal-title">Reset Password</h3>
            <p>Enter your email address and we'll send you a link to reset your password.</p>
            <div class="form-group">
                <label for="reset-email">Email</label>
                <input type="email" id="reset-email" placeholder="Enter your email">
            </div>
            <button class="modal-button" onclick="resetPassword()">Send Reset Link</button>
            <div class="success-message" id="reset-success"></div>
        </div>
    </div>
    
    <!-- Change Password Modal -->
    <div class="modal" id="change-password-modal">
        <div class="change-password-content">
            <span class="modal-close" onclick="hideChangePasswordModal()">&times;</span>
            <h3 class="change-password-title">Change Password</h3>
            
            <div class="password-input-group">
                <label for="current-password">Current Password</label>
                <input type="password" id="current-password" placeholder="Enter current password">
            </div>
            
            <div class="password-input-group">
                <label for="new-password">New Password</label>
                <input type="password" id="new-password" placeholder="Enter new password">
            </div>
            
            <div class="password-input-group">
                <label for="confirm-password">Confirm New Password</label>
                <input type="password" id="confirm-password" placeholder="Confirm new password">
            </div>
            
            <div class="password-actions">
                <button class="profile-action-btn cancel-password-btn" onclick="hideChangePasswordModal()">
                    Cancel
                </button>
                <button class="profile-action-btn save-password-btn" onclick="changePassword()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Edit BSSID Modal -->
    <div class="modal" id="edit-bssid-modal">
        <div class="edit-bssid-content">
            <span class="modal-close" onclick="hideEditBSSIDModal()">&times;</span>
            <h3 class="edit-bssid-title">Edit BSSID</h3>
            
            <div class="form-group">
                <label for="edit-bssid-input">BSSID</label>
                <input type="text" id="edit-bssid-input" placeholder="WiFi BSSID (e.g., 00:1A:2B:3C:4D:5E)">
            </div>
            
            <div class="form-group">
                <label for="edit-bssid-name">Location Name</label>
                <input type="text" id="edit-bssid-name" placeholder="Enter location name (e.g., Main Hall)" required>
            </div>
            
            <div class="form-group">
                <label for="edit-bssid-status">Status</label>
                <select id="edit-bssid-status">
                    <option value="Active">Active</option>
                    <option value="Inactive">Inactive</option>
                </select>
            </div>
            
            <div class="password-actions">
                <button class="profile-action-btn cancel-password-btn" onclick="hideEditBSSIDModal()">
                    Cancel
                </button>
                <button class="profile-action-btn save-password-btn" onclick="saveEditedBSSID()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
    
    <!-- Add Location Modal -->
    <div class="modal" id="add-location-modal">
        <div class="modal-content">
            <span class="modal-close" onclick="hideAddLocationModal()">&times;</span>
            <h3 class="modal-title">Add New Location</h3>
            
            <div class="form-group">
                <label for="location-name">Location Name</label>
                <input type="text" id="location-name" placeholder="Enter location name (e.g., Main Hall)" required>
            </div>
            
            <div class="form-group">
                <label for="location-bssid">BSSID</label>
                <input type="text" id="location-bssid" placeholder="Enter WiFi BSSID (e.g., 00:1A:2B:3C:4D:5E)" required>
            </div>
            
            <button class="modal-button" onclick="addNewLocation()">Add Location</button>
        </div>
    </div>
    
    <!-- Add BSSID to Location Modal -->
    <div class="modal" id="add-bssid-modal">
        <div class="modal-content">
            <span class="modal-close" onclick="hideAddBSSIDModal()">&times;</span>
            <h3 class="modal-title">Add BSSID to Location</h3>
            
            <div class="form-group">
                <label for="add-bssid-input">BSSID</label>
                <input type="text" id="add-bssid-input" placeholder="Enter WiFi BSSID (e.g., 00:1A:2B:3C:4D:5E)" required>
            </div>
            
            <button class="modal-button" onclick="addBSSIDToLocation()">Add BSSID</button>
        </div>
    </div>
    
    <script>
        // Global variables for timetable
        let periods = [];
        let timetableData = {}; // Will store all timetable data by semester and branch
        let currentTimetable = {
            semester: '',
            branch: '',
            periods: [],
            timetable: {
                monday: [],
                tuesday: [],
                wednesday: [],
                thursday: [],
                friday: [],
                saturday: []
            }
        };

        // Sample student data
        let students = [
            { id: "ST001", name: "Animesh", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST002", name: "Aksh", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST003", name: "Aditya", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST004", name: "Pranav", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST005", name: "Pahi", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST006", name: "Ananya", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST007", name: "Arushi", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST008", name: "Aditi", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST009", name: "Saran", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null },
            { id: "ST010", name: "Vidhi", status: "pending", timer: null, timerInterval: null, markedBy: null, verificationStatus: null }
        ];

        // Student database
        let studentDatabase = [
            { id: "ST001", name: "Animesh", email: "animesh@college.edu", semester: "3", branch: "CSE", password: "password123" },
            { id: "ST002", name: "Aksh", email: "aksh@college.edu", semester: "2", branch: "ECE", password: "password123" },
            { id: "ST003", name: "Aditya", email: "aditya@gmail.com", semester: "4", branch: "ME", password: "password123" },
            { id: "ST004", name: "Pranav", email: "pranav@college.edu", semester: "1", branch: "CSE", password: "password123" },
            { id: "ST005", name: "Pahi", email: "pahi@college.edu", semester: "5", branch: "EE", password: "password123" }
        ];

// Track currently editing student
let editingStudent = null;

function openStudentInfoPage() {
    document.getElementById('student-management-page').style.display = 'none';
    document.getElementById('student-info-page').style.display = 'block';
    filterStudents(); // Show all students by default
}

function closeStudentInfoPage() {
    document.getElementById('student-info-page').style.display = 'none';
    document.getElementById('student-management-page').style.display = 'block';
}

function filterStudents() {
    const semester = document.getElementById('student-info-semester').value;
    const branch = document.getElementById('student-info-branch').value;
    
    let filteredStudents = studentDatabase;
    
    if (semester) {
        filteredStudents = filteredStudents.filter(student => student.semester === semester);
    }
    
    if (branch) {
        filteredStudents = filteredStudents.filter(student => student.branch === branch);
    }
    
    populateStudentList(filteredStudents);
}

function populateStudentList(students) {
    const tbody = document.getElementById('student-info-list');
    tbody.innerHTML = '';
    
    if (students.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No students found</td></tr>';
        return;
    }
    
    students.forEach(student => {
        const row = document.createElement('tr');
        
        const idCell = document.createElement('td');
        idCell.textContent = student.id;
        
        const nameCell = document.createElement('td');
        nameCell.textContent = student.name;
        
        const emailCell = document.createElement('td');
        emailCell.textContent = student.email;
        
        const semesterCell = document.createElement('td');
        semesterCell.textContent = `${student.semester}${getOrdinalSuffix(student.semester)} Semester`;
        
        const branchCell = document.createElement('td');
        branchCell.textContent = getBranchName(student.branch);
        
        const actionCell = document.createElement('td');
        
        const editBtn = document.createElement('button');
        editBtn.className = 'action-btn view-btn';
        editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
        editBtn.onclick = () => showEditStudentModal(student.id);
        
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'action-btn absent-btn';
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
        deleteBtn.onclick = () => deleteStudent(student.id);
        
        actionCell.appendChild(editBtn);
        actionCell.appendChild(deleteBtn);
        
        row.appendChild(idCell);
        row.appendChild(nameCell);
        row.appendChild(emailCell);
        row.appendChild(semesterCell);
        row.appendChild(branchCell);
        row.appendChild(actionCell);
        
        tbody.appendChild(row);
    });
}

function showEditStudentModal(studentId) {
    const student = studentDatabase.find(s => s.id === studentId);
    if (!student) return;
    
    editingStudent = student;
    
    document.getElementById('edit-student-id').value = student.id;
    document.getElementById('edit-student-name').value = student.name;
    document.getElementById('edit-student-email').value = student.email;
    document.getElementById('edit-student-semester').value = student.semester;
    document.getElementById('edit-student-branch').value = student.branch;
    document.getElementById('edit-student-password').value = '';
    
    document.getElementById('edit-student-modal').style.display = 'flex';
}

function hideEditStudentModal() {
    document.getElementById('edit-student-modal').style.display = 'none';
    editingStudent = null;
}

function saveStudentChanges() {
    if (!editingStudent) return;
    
    const name = document.getElementById('edit-student-name').value;
    const email = document.getElementById('edit-student-email').value;
    const password = document.getElementById('edit-student-password').value;
    const semester = document.getElementById('edit-student-semester').value;
    const branch = document.getElementById('edit-student-branch').value;
    
    if (!name || !email || !semester || !branch) {
        alert('Please fill in all required fields');
        return;
    }
    
    // Check if email is being changed to one that already exists
    if (email !== editingStudent.email && studentDatabase.some(s => s.email === email && s.id !== editingStudent.id)) {
        alert('Email already exists for another student');
        return;
    }
    
    // Update student data
    editingStudent.name = name;
    editingStudent.email = email;
    editingStudent.semester = semester;
    editingStudent.branch = branch;
    
    // Update password if provided
    if (password) {
        editingStudent.password = password;
    }
    
    // Update the student in the attendance list if exists
    const attendanceStudent = students.find(s => s.id === editingStudent.id);
    if (attendanceStudent) {
        attendanceStudent.name = name;
    }
    
    hideEditStudentModal();
    filterStudents(); // Refresh the list
    
    alert('Student information updated successfully!');
}

function deleteStudent(studentId) {
    if (confirm('Are you sure you want to delete this student? This action cannot be undone.')) {
        // Remove from student database
        studentDatabase = studentDatabase.filter(student => student.id !== studentId);
        
        // Remove from attendance list if exists
        students = students.filter(student => student.id !== studentId);
        
        // Remove from attendance records
        attendanceRecords = attendanceRecords.filter(record => record.studentId !== studentId);
        
        filterStudents(); // Refresh the list
        alert('Student deleted successfully');
    }
}

        // Attendance records
        let attendanceRecords = [
            { studentId: "ST001", date: "2023-05-01", status: "present" },
            { studentId: "ST001", date: "2023-05-02", status: "present" },
            { studentId: "ST001", date: "2023-05-03", status: "absent" },
            { studentId: "ST001", date: "2023-05-04", status: "present" },
            { studentId: "ST002", date: "2023-05-01", status: "present" },
            { studentId: "ST002", date: "2023-05-02", status: "absent" },
            { studentId: "ST002", date: "2023-05-03", status: "present" },
            { studentId: "ST002", date: "2023-05-04", status: "present" },
            { studentId: "ST003", date: "2023-05-01", status: "absent" },
            { studentId: "ST003", date: "2023-05-02", status: "present" },
            { studentId: "ST003", date: "2023-05-03", status: "present" },
            { studentId: "ST003", date: "2023-05-04", status: "absent" },
            { studentId: "ST004", date: "2023-05-01", status: "present" },
            { studentId: "ST004", date: "2023-05-02", status: "present" },
            { studentId: "ST004", date: "2023-05-03", status: "present" },
            { studentId: "ST004", date: "2023-05-04", status: "present" },
            { studentId: "ST005", date: "2023-05-01", status: "absent" },
            { studentId: "ST005", date: "2023-05-02", status: "absent" },
            { studentId: "ST005", date: "2023-05-03", status: "present" },
            { studentId: "ST005", date: "2023-05-04", status: "present" }
        ];

        // BSSID data - now organized by location
        let locations = [
            {
                name: "Main Hall",
                bssids: [
                    { bssid: "00:1A:2B:3C:4D:5E", status: "Active" },
                    { bssid: "00:1A:2B:3C:4D:5F", status: "Active" }
                ]
            },
            {
                name: "Lab 1",
                bssids: [
                    { bssid: "00:1A:2B:3C:4D:60", status: "Active" }
                ]
            },
            {
                name: "Library",
                bssids: [
                    { bssid: "00:1A:2B:3C:4D:61", status: "Inactive" }
                ]
            }
        ];

        // Currently editing BSSID and location
        let editingBssid = null;
        let currentLocation = null;

        // Teacher profile data
        let teacherProfile = {
            id: "T001",
            name: "Animesh",
            email: "animesh@college.edu",
            department: "Computer Science",
            profilePicture: "https://cdn-icons-png.flaticon.com/512/3135/3135715.png",
            lastLogin: new Date().toLocaleString(),
            accountCreated: "January 15, 2023"
        };

        // Track if attendance session is active
        let isAttendanceSessionActive = false;
        
        // Track random ring verification
        let studentsToVerify = [];
        let currentVerificationIndex = 0;
        let verificationTimer = null;
        let verificationSecondsLeft = 30;
        
        function switchAuthTab(tabName, userType) {
            if (userType === 'teacher') {
                document.querySelectorAll(`.auth-tab`).forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`.auth-tab[onclick="switchAuthTab('${tabName}', 'teacher')"]`).classList.add('active');
                
                document.querySelectorAll(`.auth-form`).forEach(form => {
                    form.classList.remove('active');
                });
                document.getElementById(`teacher-${tabName}-form`).classList.add('active');
            }
        }
        
        function login(userType) {
            const email = document.getElementById(`${userType}-login-email`).value;
            const password = document.getElementById(`${userType}-login-password`).value;
            const rememberMe = document.getElementById(`${userType}-remember-me`).checked;
            
            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }
            
            const successMsg = document.getElementById(`${userType}-login-success`);
            successMsg.textContent = 'Login successful! Redirecting...';
            successMsg.style.display = 'block';
            
            setTimeout(() => {
                if (userType === 'teacher') {
                    document.querySelector('.portal-container').style.display = 'none';
                    document.getElementById('teacher-dashboard').style.display = 'flex';
                    
                    // Update teacher profile with login details
                    teacherProfile.name = document.getElementById('teacher-login-email').value.split('@')[0];
                    teacherProfile.email = document.getElementById('teacher-login-email').value;
                    teacherProfile.lastLogin = new Date().toLocaleString();
                    
                    // Initialize with default periods if empty
                    if (Object.keys(timetableData).length === 0) {
                        // Create a default timetable structure
                        initializeDefaultTimetable();
                    }
                }
            }, 1000);
        }
        
        function initializeDefaultTimetable() {
            // Create 8 default periods from 8:00 to 15:00 (45 min each)
            const defaultPeriods = [];
            for (let i = 0; i < 8; i++) {
                const startHour = 8 + Math.floor((i * 45) / 60);
                const startMinute = (i * 45) % 60;
                const endHour = 8 + Math.floor(((i + 1) * 45) / 60);
                const endMinute = ((i + 1) * 45) % 60;
                
                const startStr = `${String(startHour).padStart(2, '0')}:${String(startMinute).padStart(2, '0')}`;
                const endStr = `${String(endHour).padStart(2, '0')}:${String(endMinute).padStart(2, '0')}`;
                
                defaultPeriods.push({
                    number: i + 1,
                    startTime: startStr,
                    endTime: endStr,
                    editable: true
                });
            }
            
            // Initialize timetable data for all semesters and branches
            const semesters = ['1', '2', '3', '4', '5', '6', '7', '8'];
            const branches = ['CSE', 'ECE', 'ME', 'CE', 'EE', 'IT'];
            
            semesters.forEach(semester => {
                branches.forEach(branch => {
                    const key = `${semester}_${branch}`;
                    
                    // Initialize periods
                    const periods = JSON.parse(JSON.stringify(defaultPeriods));
                    
                    // Initialize timetable data for each day
                    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                    const timetable = {};
                    
                    days.forEach(day => {
                        timetable[day] = [];
                        for (let i = 0; i < periods.length; i++) {
                            timetable[day].push({
                                period: i + 1,
                                subject: '',
                                room: '',
                                isBreak: false
                            });
                        }
                    });
                    
                    timetableData[key] = {
                        semester: semester,
                        branch: branch,
                        periods: periods,
                        timetable: timetable
                    };
                });
            });
            
            // Set current timetable to first semester CSE by default
            currentTimetable = timetableData['1_CSE'];
        }
        
        function signup(userType) {
            const name = document.getElementById(`${userType}-signup-name`).value;
            const email = document.getElementById(`${userType}-signup-email`).value;
            const password = document.getElementById(`${userType}-signup-password`).value;
            const confirm = document.getElementById(`${userType}-signup-confirm`).value;
            const rememberMe = document.getElementById(`${userType}-remember-me-signup`).checked;
            
            if (!name || !email || !password || !confirm) {
                alert('Please fill in all fields');
                return;
            }
            
            if (password !== confirm) {
                alert('Passwords do not match');
                return;
            }
            
            const successMsg = document.getElementById(`${userType}-signup-success`);
            successMsg.textContent = 'Account created successfully!';
            successMsg.style.display = 'block';
            
            setTimeout(() => {
                alert(`${userType.charAt(0).toUpperCase() + userType.slice(1)} signup attempt for: ${name}, email: ${email}\nRemember me: ${rememberMe ? 'Yes' : 'No'}`);
                switchAuthTab('login', userType);
            }, 1500);
        }
        
        function showForgotPasswordModal(userType) {
            document.getElementById('forgot-password-modal').style.display = 'flex';
        }
        
        function hideForgotPasswordModal() {
            document.getElementById('forgot-password-modal').style.display = 'none';
            document.getElementById('reset-success').style.display = 'none';
        }
        
        function resetPassword() {
            const email = document.getElementById('reset-email').value;
            
            if (!email) {
                alert('Please enter your email address');
                return;
            }
            
            const successMsg = document.getElementById('reset-success');
            successMsg.textContent = 'Password reset link sent to your email!';
            successMsg.style.display = 'block';
            
            setTimeout(() => {
                hideForgotPasswordModal();
                alert(`Password reset link would be sent to: ${email}`);
            }, 1500);
        }
        
        function logoutTeacher() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('profile-page').style.display = 'none';
            document.querySelector('.portal-container').style.display = 'flex';
            
            document.getElementById('teacher-login-email').value = '';
            document.getElementById('teacher-login-password').value = '';
            document.getElementById('teacher-remember-me').checked = false;
        }
        
        function openOption(option) {
            alert(`Opening ${option.replace('-', ' ')} section`);
        }

        function openStudentManagementPage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('student-management-page').style.display = 'block';
        }

        function closeStudentManagementPage() {
            document.getElementById('student-management-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function openReportsPage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('reports-page').style.display = 'block';
            
            // Set default date range (last 30 days)
            const endDate = new Date();
            const startDate = new Date();
            startDate.setDate(endDate.getDate() - 30);
            
            document.getElementById('report-start-date').valueAsDate = startDate;
            document.getElementById('report-end-date').valueAsDate = endDate;
            
            generateReports();
        }

        function closeReportsPage() {
            document.getElementById('reports-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function openAttendanceDashboard() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('attendance-dashboard').style.display = 'block';
            populateStudentsList();
        }

        function closeAttendanceDashboard() {
            document.getElementById('attendance-dashboard').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function openManualAttendancePage() {
            document.getElementById('attendance-dashboard').style.display = 'none';
            document.getElementById('manual-attendance-page').style.display = 'block';
            populateManualStudentsList();
        }

        function closeManualAttendancePage() {
            document.getElementById('manual-attendance-page').style.display = 'none';
            document.getElementById('attendance-dashboard').style.display = 'block';
        }
        
        function openTimetablePage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('timetable-page').style.display = 'block';
            generateTimetable();
        }
        
        function closeTimetablePage() {
            document.getElementById('timetable-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function openBSSIDPage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('bssid-page').style.display = 'block';
            populateBSSIDLocations();
        }

        function closeBSSIDPage() {
            document.getElementById('bssid-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function openProfilePage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('profile-page').style.display = 'block';
            
            // Update profile information
            document.getElementById('profile-name').textContent = teacherProfile.name;
            document.getElementById('profile-email').textContent = teacherProfile.email;
            document.getElementById('profile-id').textContent = teacherProfile.id;
            document.getElementById('profile-department').textContent = teacherProfile.department;
            document.getElementById('profile-last-login').textContent = teacherProfile.lastLogin;
            document.getElementById('profile-created').textContent = teacherProfile.accountCreated;
            document.getElementById('profile-picture').src = teacherProfile.profilePicture;
        }

        function closeProfilePage() {
            document.getElementById('profile-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function handleProfilePictureUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('profile-picture');
                    img.src = e.target.result;
                    
                    // Also update the profile button image
                    const profileBtnImg = document.getElementById('profile-img');
                    profileBtnImg.src = e.target.result;
                    
                    // Update the teacher profile data
                    teacherProfile.profilePicture = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function showChangePasswordModal() {
            document.getElementById('change-password-modal').style.display = 'flex';
        }

        function hideChangePasswordModal() {
            document.getElementById('change-password-modal').style.display = 'none';
            // Clear the fields
            document.getElementById('current-password').value = '';
            document.getElementById('new-password').value = '';
            document.getElementById('confirm-password').value = '';
        }

        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            
            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('Please fill in all fields');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                alert('New passwords do not match');
                return;
            }
            
            // In a real app, you would verify the current password with the server
            // For this demo, we'll just assume it's correct
            alert('Password changed successfully!');
            hideChangePasswordModal();
        }

        function showAddLocationModal() {
            document.getElementById('add-location-modal').style.display = 'flex';
        }

        function hideAddLocationModal() {
            document.getElementById('add-location-modal').style.display = 'none';
            document.getElementById('location-name').value = '';
            document.getElementById('location-bssid').value = '';
        }

        function showAddBSSIDModal(location) {
            currentLocation = location;
            document.getElementById('add-bssid-modal').style.display = 'flex';
        }

        function hideAddBSSIDModal() {
            document.getElementById('add-bssid-modal').style.display = 'none';
            document.getElementById('add-bssid-input').value = '';
            currentLocation = null;
        }

        function populateBSSIDLocations() {
            const container = document.getElementById('bssid-locations-container');
            container.innerHTML = '';
            
            if (locations.length === 0) {
                container.innerHTML = '<p>No locations added yet. Click "Add New Location" to get started.</p>';
                return;
            }
            
            locations.forEach(location => {
                const locationGroup = document.createElement('div');
                locationGroup.className = 'location-group';
                
                const locationHeader = document.createElement('div');
                locationHeader.className = 'location-header';
                
                const locationName = document.createElement('div');
                locationName.className = 'location-name';
                locationName.textContent = location.name;
                
                const locationActions = document.createElement('div');
                locationActions.className = 'location-actions';
                
                const addBSSIDBtn = document.createElement('button');
                addBSSIDBtn.className = 'location-btn add-bssid-btn';
                addBSSIDBtn.innerHTML = '<i class="fas fa-plus"></i> Add BSSID';
                addBSSIDBtn.onclick = () => showAddBSSIDModal(location);
                
                const deleteLocationBtn = document.createElement('button');
                deleteLocationBtn.className = 'location-btn delete-location-btn';
                deleteLocationBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                deleteLocationBtn.onclick = () => deleteLocation(location.name);
                
                locationActions.appendChild(addBSSIDBtn);
                locationActions.appendChild(deleteLocationBtn);
                locationHeader.appendChild(locationName);
                locationHeader.appendChild(locationActions);
                
                const bssidTable = document.createElement('table');
                bssidTable.className = 'bssid-list';
                
                const thead = document.createElement('thead');
                thead.innerHTML = `
                    <tr>
                        <th>BSSID</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                `;
                
                const tbody = document.createElement('tbody');
                location.bssids.forEach(bssid => {
                    const row = document.createElement('tr');
                    
                    const bssidCell = document.createElement('td');
                    bssidCell.textContent = bssid.bssid;
                    
                    const statusCell = document.createElement('td');
                    const statusSpan = document.createElement('span');
                    statusSpan.className = `bssid-status status-${bssid.status.toLowerCase()}`;
                    statusSpan.textContent = bssid.status;
                    statusCell.appendChild(statusSpan);
                    
                    const actionCell = document.createElement('td');
                    
                    const editBtn = document.createElement('button');
                    editBtn.className = 'action-btn view-btn';
                    editBtn.innerHTML = '<i class="fas fa-edit"></i> Edit';
                    editBtn.onclick = () => editBSSID(location.name, bssid.bssid);
                    
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'action-btn absent-btn';
                    deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Delete';
                    deleteBtn.onclick = () => deleteBSSID(location.name, bssid.bssid);
                    
                    const toggleBtn = document.createElement('button');
                    toggleBtn.className = 'action-btn view-btn';
                    toggleBtn.innerHTML = bssid.status === 'Active' ? '<i class="fas fa-toggle-on"></i> Deactivate' : '<i class="fas fa-toggle-off"></i> Activate';
                    toggleBtn.onclick = () => toggleBSSIDStatus(location.name, bssid.bssid);
                    
                    actionCell.appendChild(editBtn);
                    actionCell.appendChild(toggleBtn);
                    actionCell.appendChild(deleteBtn);
                    
                    row.appendChild(bssidCell);
                    row.appendChild(statusCell);
                    row.appendChild(actionCell);
                    
                    tbody.appendChild(row);
                });
                
                bssidTable.appendChild(thead);
                bssidTable.appendChild(tbody);
                
                locationGroup.appendChild(locationHeader);
                locationGroup.appendChild(bssidTable);
                
                container.appendChild(locationGroup);
            });
        }

        function addNewLocation() {
            const name = document.getElementById('location-name').value;
            const bssid = document.getElementById('location-bssid').value;
            
            if (!name || !bssid) {
                alert('Please fill in all fields');
                return;
            }
            
            // Simple BSSID format validation (basic check for MAC address format)
            if (!/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(bssid)) {
                alert('Please enter a valid BSSID in format like 00:1A:2B:3C:4D:5E');
                return;
            }
            
            // Check if location already exists
            const existingLocation = locations.find(loc => loc.name.toLowerCase() === name.toLowerCase());
            
            if (existingLocation) {
                // Check if BSSID already exists in this location
                if (existingLocation.bssids.some(b => b.bssid === bssid)) {
                    alert('This BSSID is already registered for this location');
                    return;
                }
                
                // Add BSSID to existing location
                existingLocation.bssids.push({
                    bssid: bssid,
                    status: 'Active'
                });
            } else {
                // Create new location with this BSSID
                locations.push({
                    name: name,
                    bssids: [
                        {
                            bssid: bssid,
                            status: 'Active'
                        }
                    ]
                });
            }
            
            // Clear inputs
            document.getElementById('location-name').value = '';
            document.getElementById('location-bssid').value = '';
            
            // Hide modal
            hideAddLocationModal();
            
            // Refresh list
            populateBSSIDLocations();
        }

        function addBSSIDToLocation() {
            const bssid = document.getElementById('add-bssid-input').value;
            
            if (!bssid || !currentLocation) {
                alert('Please fill in all fields');
                return;
            }
            
            // Simple BSSID format validation (basic check for MAC address format)
            if (!/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(bssid)) {
                alert('Please enter a valid BSSID in format like 00:1A:2B:3C:4D:5E');
                return;
            }
            
            // Check if BSSID already exists in this location
            if (currentLocation.bssids.some(b => b.bssid === bssid)) {
                alert('This BSSID is already registered for this location');
                return;
            }
            
            // Add BSSID to location
            currentLocation.bssids.push({
                bssid: bssid,
                status: 'Active'
            });
            
            // Clear input
            document.getElementById('add-bssid-input').value = '';
            
            // Hide modal
            hideAddBSSIDModal();
            
            // Refresh list
            populateBSSIDLocations();
        }

        function editBSSID(locationName, bssid) {
            const location = locations.find(loc => loc.name === locationName);
            if (!location) return;
            
            const bssidToEdit = location.bssids.find(b => b.bssid === bssid);
            if (!bssidToEdit) return;
            
            editingBssid = bssidToEdit;
            currentLocation = location;
            
            document.getElementById('edit-bssid-input').value = bssidToEdit.bssid;
            document.getElementById('edit-bssid-name').value = locationName;
            document.getElementById('edit-bssid-status').value = bssidToEdit.status;
            
            document.getElementById('edit-bssid-modal').style.display = 'flex';
        }

        function hideEditBSSIDModal() {
            document.getElementById('edit-bssid-modal').style.display = 'none';
            editingBssid = null;
            currentLocation = null;
        }

        function saveEditedBSSID() {
            if (!editingBssid || !currentLocation) return;
            
            const newBSSID = document.getElementById('edit-bssid-input').value;
            const newName = document.getElementById('edit-bssid-name').value;
            const newStatus = document.getElementById('edit-bssid-status').value;
            
            if (!newBSSID || !newName) {
                alert('BSSID and location name are required');
                return;
            }
            
            // Simple BSSID format validation (basic check for MAC address format)
            if (!/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/.test(newBSSID)) {
                alert('Please enter a valid BSSID in format like 00:1A:2B:3C:4D:5E');
                return;
            }
            
            // Check if BSSID is being changed to one that already exists in this location
            if (newBSSID !== editingBssid.bssid && 
                currentLocation.bssids.some(b => b.bssid === newBSSID && b !== editingBssid)) {
                alert('This BSSID is already registered for this location');
                return;
            }
            
            // Check if location name is being changed
            if (newName !== currentLocation.name) {
                // Check if new location name already exists
                const existingLocation = locations.find(loc => loc.name.toLowerCase() === newName.toLowerCase());
                
                if (existingLocation && existingLocation !== currentLocation) {
                    // Move BSSID to existing location
                    existingLocation.bssids.push({
                        bssid: newBSSID,
                        status: newStatus
                    });
                    
                    // Remove from current location
                    currentLocation.bssids = currentLocation.bssids.filter(b => b !== editingBssid);
                    
                    // If current location has no more BSSIDs, remove it
                    if (currentLocation.bssids.length === 0) {
                        locations = locations.filter(loc => loc !== currentLocation);
                    }
                } else {
                    // Just rename the location
                    currentLocation.name = newName;
                    editingBssid.bssid = newBSSID;
                    editingBssid.status = newStatus;
                }
            } else {
                // Just update the BSSID and status
                editingBssid.bssid = newBSSID;
                editingBssid.status = newStatus;
            }
            
            hideEditBSSIDModal();
            populateBSSIDLocations();
        }

        function deleteBSSID(locationName, bssid) {
            if (confirm('Are you sure you want to delete this BSSID?')) {
                const location = locations.find(loc => loc.name === locationName);
                if (location) {
                    location.bssids = location.bssids.filter(b => b.bssid !== bssid);
                    
                    // If this was the last BSSID in the location, remove the location
                    if (location.bssids.length === 0) {
                        locations = locations.filter(loc => loc !== location);
                    }
                    
                    populateBSSIDLocations();
                }
            }
        }

        function deleteLocation(locationName) {
            if (confirm(`Are you sure you want to delete the location "${locationName}" and all its BSSIDs?`)) {
                locations = locations.filter(loc => loc.name !== locationName);
                populateBSSIDLocations();
            }
        }

        function toggleBSSIDStatus(locationName, bssid) {
            const location = locations.find(loc => loc.name === locationName);
            if (location) {
                const bssidToUpdate = location.bssids.find(b => b.bssid === bssid);
                if (bssidToUpdate) {
                    bssidToUpdate.status = bssidToUpdate.status === 'Active' ? 'Inactive' : 'Active';
                    populateBSSIDLocations();
                }
            }
        }
        
        function filterTimetable() {
            const semester = document.getElementById('timetable-semester').value;
            const branch = document.getElementById('timetable-branch').value;
            
            if (!semester || !branch) {
                alert('Please select both semester and branch');
                document.getElementById('timetable-semester').value = currentTimetable.semester;
                document.getElementById('timetable-branch').value = currentTimetable.branch;
                return;
            }
            
            const key = `${semester}_${branch}`;
            
            if (timetableData[key]) {
                currentTimetable = timetableData[key];
            } else {
                // Create a new timetable for this semester and branch
                const newPeriods = currentTimetable.periods.map(p => ({
                    number: p.number,
                    startTime: p.startTime,
                    endTime: p.endTime,
                    editable: p.editable
                }));
                
                const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                const newTimetable = {};
                
                days.forEach(day => {
                    newTimetable[day] = currentTimetable.timetable[day].map(p => ({
                        period: p.period,
                        subject: '',
                        room: '',
                        isBreak: p.isBreak
                    }));
                });
                
                currentTimetable = {
                    semester: semester,
                    branch: branch,
                    periods: newPeriods,
                    timetable: newTimetable
                };
                
                timetableData[key] = currentTimetable;
            }
            
            generateTimetable();
        }
        
        function generateTimetable() {
            const tbody = document.getElementById('timetable-body');
            tbody.innerHTML = '';
            
            // Update the current timetable filters
            document.getElementById('timetable-semester').value = currentTimetable.semester;
            document.getElementById('timetable-branch').value = currentTimetable.branch;
            
            currentTimetable.periods.forEach((period, index) => {
                const row = document.createElement('tr');
                
                // Time cell with editable times
                const timeCell = document.createElement('td');
                
                const timeEditDiv = document.createElement('div');
                timeEditDiv.className = 'time-edit';
                
                const startTimeInput = document.createElement('input');
                startTimeInput.type = 'time';
                startTimeInput.value = period.startTime;
                startTimeInput.setAttribute('data-period', period.number);
                startTimeInput.setAttribute('data-time-type', 'start');
                startTimeInput.addEventListener('change', function() {
                    updatePeriodTime(this);
                });
                
                // Add keyboard support for time editing
                startTimeInput.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                        e.preventDefault();
                        adjustTime(this, e.key === 'ArrowUp' ? 1 : -1);
                    }
                });
                
                const endTimeInput = document.createElement('input');
                endTimeInput.type = 'time';
                endTimeInput.value = period.endTime;
                endTimeInput.setAttribute('data-period', period.number);
                endTimeInput.setAttribute('data-time-type', 'end');
                endTimeInput.addEventListener('change', function() {
                    updatePeriodTime(this);
                });
                
                // Add keyboard support for time editing
                endTimeInput.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                        e.preventDefault();
                        adjustTime(this, e.key === 'ArrowUp' ? 1 : -1);
                    }
                });
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-period-btn';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.setAttribute('data-period', period.number);
                deleteBtn.addEventListener('click', function() {
                    deletePeriod(period.number);
                });
                
                timeEditDiv.appendChild(startTimeInput);
                timeEditDiv.appendChild(document.createTextNode(' - '));
                timeEditDiv.appendChild(endTimeInput);
                timeEditDiv.appendChild(deleteBtn);
                
                timeCell.appendChild(timeEditDiv);
                timeCell.appendChild(document.createElement('br'));
                timeCell.appendChild(document.createTextNode(`Period ${period.number}`));
                
                row.appendChild(timeCell);
                
                // Cells for each day
                const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                days.forEach(day => {
                    const cell = document.createElement('td');
                    const periodData = currentTimetable.timetable[day][index];
                    
                    if (periodData.isBreak) {
                        cell.className = 'break-cell';
                        cell.textContent = 'BREAK';
                    } else {
                        // Create container for subject and room inputs
                        const container = document.createElement('div');
                        
                        // Subject input
                        const subjectInput = document.createElement('input');
                        subjectInput.type = 'text';
                        subjectInput.className = 'subject-input';
                        subjectInput.setAttribute('data-day', day);
                        subjectInput.setAttribute('data-period', period.number);
                        subjectInput.setAttribute('data-field', 'subject');
                        subjectInput.placeholder = 'Enter course name';
                        subjectInput.value = periodData.subject || '';
                        
                        subjectInput.addEventListener('change', function() {
                            updateTimetableData(this);
                        });
                        
                        // Room input
                        const roomInput = document.createElement('input');
                        roomInput.type = 'text';
                        roomInput.className = 'room-input';
                        roomInput.setAttribute('data-day', day);
                        roomInput.setAttribute('data-period', period.number);
                        roomInput.setAttribute('data-field', 'room');
                        roomInput.placeholder = 'Enter room number';
                        roomInput.value = periodData.room || '';
                        
                        roomInput.addEventListener('change', function() {
                            updateTimetableData(this);
                        });
                        
                        container.appendChild(subjectInput);
                        container.appendChild(roomInput);
                        cell.appendChild(container);
                    }
                    
                    row.appendChild(cell);
                });
                
                tbody.appendChild(row);
            });
        }
        
        function adjustTime(input, direction) {
            // Parse current time
            const [hours, minutes] = input.value.split(':').map(Number);
            let totalMinutes = hours * 60 + minutes;
            
            // Adjust by 5 minutes
            totalMinutes += direction * 5;
            
            // Handle overflow/underflow
            if (totalMinutes < 0) totalMinutes = 0;
            if (totalMinutes >= 1440) totalMinutes = 1435; // 23:55
            
            // Convert back to time string
            const newHours = Math.floor(totalMinutes / 60);
            const newMinutes = totalMinutes % 60;
            const newTime = `${String(newHours).padStart(2, '0')}:${String(newMinutes).padStart(2, '0')}`;
            
            // Update input value
            input.value = newTime;
            
            // Trigger change event
            const event = new Event('change');
            input.dispatchEvent(event);
        }
        
        function updatePeriodTime(inputElement) {
            const periodNum = parseInt(inputElement.getAttribute('data-period'));
            const timeType = inputElement.getAttribute('data-time-type');
            const newTime = inputElement.value;
            
            const periodIndex = currentTimetable.periods.findIndex(p => p.number === periodNum);
            if (periodIndex !== -1) {
                if (timeType === 'start') {
                    // Validate start time is before end time
                    const currentEndTime = currentTimetable.periods[periodIndex].endTime;
                    if (newTime >= currentEndTime) {
                        alert('Start time must be before end time');
                        inputElement.value = currentTimetable.periods[periodIndex].startTime;
                        return;
                    }
                    currentTimetable.periods[periodIndex].startTime = newTime;
                } else {
                    // Validate end time is after start time
                    const currentStartTime = currentTimetable.periods[periodIndex].startTime;
                    if (newTime <= currentStartTime) {
                        alert('End time must be after start time');
                        inputElement.value = currentTimetable.periods[periodIndex].endTime;
                        return;
                    }
                    currentTimetable.periods[periodIndex].endTime = newTime;
                }
            }
        }
        
        function updateTimetableData(inputElement) {
            const day = inputElement.getAttribute('data-day');
            const period = parseInt(inputElement.getAttribute('data-period'));
            const field = inputElement.getAttribute('data-field');
            const value = inputElement.value;
            
            const periodIndex = currentTimetable.periods.findIndex(p => p.number === period);
            
            if (periodIndex !== -1) {
                if (value.toUpperCase() === 'BREAK') {
                    currentTimetable.timetable[day][periodIndex].isBreak = true;
                    currentTimetable.timetable[day][periodIndex].subject = '';
                    currentTimetable.timetable[day][periodIndex].room = '';
                    // Regenerate to show break cell
                    generateTimetable();
                } else {
                    currentTimetable.timetable[day][periodIndex].isBreak = false;
                    
                    // Update the specific field
                    if (field === 'subject') {
                        currentTimetable.timetable[day][periodIndex].subject = value;
                    } else if (field === 'room') {
                        currentTimetable.timetable[day][periodIndex].room = value;
                    }
                }
            }
        }
        
        function addNewPeriod() {
            if (currentTimetable.periods.length === 0) {
                // If no periods exist, create first period from 8:00-8:45
                currentTimetable.periods.push({
                    number: 1,
                    startTime: '08:00',
                    endTime: '08:45',
                    editable: true
                });
            } else {
                const lastPeriod = currentTimetable.periods[currentTimetable.periods.length - 1];
                const [lastEndHour, lastEndMinute] = lastPeriod.endTime.split(':').map(Number);
                const lastEndTotal = lastEndHour * 60 + lastEndMinute;
                
                // Add 45 minutes by default
                const newEndTotal = lastEndTotal + 45;
                const newEndHour = Math.floor(newEndTotal / 60);
                const newEndMinute = newEndTotal % 60;
                const newEndTime = `${String(newEndHour).padStart(2, '0')}:${String(newEndMinute).padStart(2, '0')}`;
                
                const newPeriod = {
                    number: currentTimetable.periods.length + 1,
                    startTime: lastPeriod.endTime,
                    endTime: newEndTime,
                    editable: true
                };
                
                currentTimetable.periods.push(newPeriod);
            }
            
            // Add to timetable data for each day
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            days.forEach(day => {
                currentTimetable.timetable[day].push({
                    period: currentTimetable.periods.length,
                    subject: '',
                    room: '',
                    isBreak: false
                });
            });
            
            generateTimetable();
        }
        
        function deletePeriod(periodNum) {
            if (currentTimetable.periods.length <= 1) {
                alert('You must have at least one period');
                return;
            }
            
            if (confirm(`Are you sure you want to delete Period ${periodNum}?`)) {
                const periodIndex = currentTimetable.periods.findIndex(p => p.number === periodNum);
                if (periodIndex !== -1) {
                    currentTimetable.periods.splice(periodIndex, 1);
                    
                    // Renumber remaining periods
                    currentTimetable.periods.forEach((period, index) => {
                        period.number = index + 1;
                    });
                    
                    // Remove from timetable data for each day
                    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                    days.forEach(day => {
                        currentTimetable.timetable[day].splice(periodIndex, 1);
                        // Renumber remaining periods in timetable data
                        currentTimetable.timetable[day].forEach((periodData, index) => {
                            periodData.period = index + 1;
                        });
                    });
                    
                    generateTimetable();
                }
            }
        }
        
        function openNoticePage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('notice-page').style.display = 'block';
            filterNotices();
        }

        function addBreakToAllDays() {
            const breakPeriod = prompt("Enter period number to set as break for all days:");
            
            if (breakPeriod && !isNaN(breakPeriod)) {
                const periodNum = parseInt(breakPeriod);
                if (periodNum > 0 && periodNum <= currentTimetable.periods.length) {
                    const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
                    days.forEach(day => {
                        currentTimetable.timetable[day][periodNum - 1].isBreak = true;
                        currentTimetable.timetable[day][periodNum - 1].subject = '';
                        currentTimetable.timetable[day][periodNum - 1].room = '';
                    });
                    
                    generateTimetable();
                } else {
                    alert('Invalid period number');
                }
            }
        }
        
        function saveTimetable() {
            // Save the current timetable data to our storage
            const key = `${currentTimetable.semester}_${currentTimetable.branch}`;
            timetableData[key] = currentTimetable;
            
            console.log('Timetable saved:', timetableData);
            alert('Timetable saved successfully!');
        }

        // Student Management Functions
        document.getElementById('student-form').addEventListener('submit', function(e) {
            e.preventDefault();
            createStudent();
        });

        function createStudent() {
            const id = document.getElementById('student-id').value;
            const name = document.getElementById('student-name').value;
            const email = document.getElementById('student-email').value;
            const password = document.getElementById('student-password').value;
            const semester = document.getElementById('student-semester').value;
            const branch = document.getElementById('student-branch').value;
            
            // Validate all fields
            if (!id || !name || !email || !password || !semester || !branch) {
                alert('Please fill in all fields');
                return;
            }
            
            // Check if student ID already exists
            if (studentDatabase.some(student => student.id === id)) {
                alert('Student ID already exists');
                return;
            }
            
            // Check if email already exists
            if (studentDatabase.some(student => student.email === email)) {
                alert('Email already exists');
                return;
            }
            
            // Create new student
            const newStudent = {
                id,
                name,
                email,
                password,
                semester,
                branch
            };
            
            // Add to database
            studentDatabase.push(newStudent);
            
            // Also add to attendance students list if not already present
            if (!students.some(student => student.id === id)) {
                students.push({
                    id,
                    name,
                    status: "pending",
                    timer: null,
                    timerInterval: null,
                    markedBy: null,
                    verificationStatus: null
                });
            }
            
            // Clear form
            document.getElementById('student-form').reset();
            
            // Show success message
            alert(`Student ${name} (${id}) created successfully!`);
        }

        // Notice Data
        let notices = [
            {
                id: 'N001',
                heading: 'Mid-Term Exam Schedule',
                content: 'The mid-term exams will be conducted from 15th to 20th November. Please check the timetable on the notice board.',
                type: 'exam',
                department: 'Examination Department',
                semester: ['all'],
                branch: ['all'],
                important: true,
                date: '2023-11-01',
                attachments: []
            },
            {
                id: 'N002',
                heading: 'College Holiday',
                content: 'The college will remain closed on 12th November for Diwali celebrations.',
                type: 'holiday',
                department: 'Administration',
                semester: ['all'],
                branch: ['all'],
                important: false,
                date: '2023-11-05',
                attachments: []
            }
        ];

        // Notice Functions
        function openNoticePage() {
            document.getElementById('teacher-dashboard').style.display = 'none';
            document.getElementById('notice-page').style.display = 'block';
            filterNotices();
        }

        function closeNoticePage() {
            document.getElementById('notice-page').style.display = 'none';
            document.getElementById('teacher-dashboard').style.display = 'flex';
        }

        function showAddNoticeModal() {
            document.getElementById('add-notice-modal').style.display = 'flex';
        }

        function hideAddNoticeModal() {
            document.getElementById('add-notice-modal').style.display = 'none';
            document.getElementById('notice-heading').value = '';
            document.getElementById('notice-content').value = '';
            document.getElementById('notice-important').checked = false;
            document.getElementById('notice-files').value = '';
            
            // Reset multi-selects
            const semesterSelect = document.getElementById('notice-semester-select');
            const branchSelect = document.getElementById('notice-branch-select');
            
            for (let i = 0; i < semesterSelect.options.length; i++) {
                semesterSelect.options[i].selected = false;
            }
            
            for (let i = 0; i < branchSelect.options.length; i++) {
                branchSelect.options[i].selected = false;
            }
            
            // Select "All" by default
            semesterSelect.options[0].selected = true;
            branchSelect.options[0].selected = true;
        }

        function saveNotice() {
            const heading = document.getElementById('notice-heading').value;
            const content = document.getElementById('notice-content').value;
            const type = document.getElementById('notice-type-select').value;
            const department = document.getElementById('notice-department').value;
            const important = document.getElementById('notice-important').checked;
            
            // Get selected semesters
            const semesterSelect = document.getElementById('notice-semester-select');
            const selectedSemesters = [];
            for (let i = 0; i < semesterSelect.options.length; i++) {
                if (semesterSelect.options[i].selected) {
                    if (semesterSelect.options[i].value === 'all') {
                        selectedSemesters.push('all');
                        break;
                    }
                    selectedSemesters.push(semesterSelect.options[i].value);
                }
            }
            
            // Get selected branches
            const branchSelect = document.getElementById('notice-branch-select');
            const selectedBranches = [];
            for (let i = 0; i < branchSelect.options.length; i++) {
                if (branchSelect.options[i].selected) {
                    if (branchSelect.options[i].value === 'all') {
                        selectedBranches.push('all');
                        break;
                    }
                    selectedBranches.push(branchSelect.options[i].value);
                }
            }
            
            // Validate inputs
            if (!heading || !content || !type || !department || selectedSemesters.length === 0 || selectedBranches.length === 0) {
                alert('Please fill all required fields');
                return;
            }
            
            // Process file attachments
            const filesInput = document.getElementById('notice-files');
            const attachments = [];
            
            if (filesInput.files.length > 0) {
                for (let i = 0; i < filesInput.files.length; i++) {
                    attachments.push({
                        name: filesInput.files[i].name,
                        size: filesInput.files[i].size,
                        type: filesInput.files[i].type
                    });
                }
            }
            
            // Create new notice
            const newNotice = {
                id: 'N' + String(notices.length + 1).padStart(3, '0'),
                heading: heading,
                content: content,
                type: type,
                department: department,
                semester: selectedSemesters,
                branch: selectedBranches,
                important: important,
                date: new Date().toISOString().split('T')[0],
                attachments: attachments
            };
            
            notices.push(newNotice);
            hideAddNoticeModal();
            filterNotices();
            
            alert('Notice published successfully!');
        }

        function filterNotices() {
            const semester = document.getElementById('notice-semester').value;
            const branch = document.getElementById('notice-branch').value;
            const type = document.getElementById('notice-type').value;
            
            const container = document.getElementById('notices-list');
            container.innerHTML = '';
            
            let filteredNotices = notices;
            
            // Sort by date (newest first)
            filteredNotices.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            if (semester) {
                filteredNotices = filteredNotices.filter(notice => 
                    notice.semester.includes('all') || notice.semester.includes(semester)
                );
            }
            
            if (branch) {
                filteredNotices = filteredNotices.filter(notice => 
                    notice.branch.includes('all') || notice.branch.includes(branch)
                );
            }
            
            if (type) {
                filteredNotices = filteredNotices.filter(notice => notice.type === type);
            }
            
            if (filteredNotices.length === 0) {
                container.innerHTML = '<p>No notices found matching your criteria.</p>';
                return;
            }
            
            filteredNotices.forEach(notice => {
                const noticeCard = document.createElement('div');
                noticeCard.className = `notice-card ${notice.type} ${notice.important ? 'important' : ''}`;
                
                const typeClass = `type-${notice.type}`;
                const typeText = notice.type.charAt(0).toUpperCase() + notice.type.slice(1);
                
                let branchesText = '';
                if (notice.branch.includes('all')) {
                    branchesText = 'All Branches';
                } else {
                    branchesText = notice.branch.map(b => getBranchName(b)).join(', ');
                }
                
                let semestersText = '';
                if (notice.semester.includes('all')) {
                    semestersText = 'All Semesters';
                } else {
                    semestersText = notice.semester.map(s => `${s}${getOrdinalSuffix(s)}`).join(', ');
                }
                
                noticeCard.innerHTML = `
                    <div class="notice-heading">
                        <span>${notice.heading}</span>
                        <span class="notice-type ${typeClass}">${typeText}</span>
                    </div>
                    <div class="notice-meta">
                        <div>
                            <span class="notice-department">${notice.department}</span> | 
                            <span>For: ${semestersText}, ${branchesText}</span>
                        </div>
                        <div class="notice-date">${formatNoticeDate(notice.date)}</div>
                    </div>
                    <div class="notice-content">${notice.content}</div>
                    
                    ${notice.attachments.length > 0 ? `
                    <div class="notice-attachments">
                        <strong>Attachments:</strong>
                        ${notice.attachments.map(file => `
                            <div class="attachment-item">
                                <i class="fas fa-paperclip attachment-icon"></i>
                                <a href="#" class="attachment-name">${file.name}</a>
                                <span>(${formatFileSize(file.size)})</span>
                            </div>
                        `).join('')}
                    </div>
                    ` : ''}
                    
                    <div class="notice-actions">
                        <button class="delete-notice-btn" onclick="deleteNotice('${notice.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                
                container.appendChild(noticeCard);
            });
        }

        function formatNoticeDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
            });
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' bytes';
            else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
            else return (bytes / 1048576).toFixed(1) + ' MB';
        }

        function deleteNotice(noticeId) {
            if (confirm('Are you sure you want to delete this notice?')) {
                notices = notices.filter(notice => notice.id !== noticeId);
                filterNotices();
            }
        }        

        // Reports Functions
        function generateReports() {
            const semester = document.getElementById('report-semester').value;
            const branch = document.getElementById('report-branch').value;
            const startDate = document.getElementById('report-start-date').value;
            const endDate = document.getElementById('report-end-date').value;
            
            // Validate date range
            if (startDate && endDate && startDate > endDate) {
                alert('End date must be after start date');
                return;
            }
            
            const tbody = document.getElementById('reports-body');
            tbody.innerHTML = '';
            
            let filteredStudents = studentDatabase;
            
            if (semester) {
                filteredStudents = filteredStudents.filter(student => student.semester === semester);
            }
            
            if (branch) {
                filteredStudents = filteredStudents.filter(student => student.branch === branch);
            }
            
            filteredStudents.forEach(student => {
                const row = document.createElement('tr');
                
                const idCell = document.createElement('td');
                idCell.textContent = student.id;
                
                const nameCell = document.createElement('td');
                nameCell.textContent = student.name;
                
                const semesterCell = document.createElement('td');
                semesterCell.textContent = `${student.semester}${getOrdinalSuffix(student.semester)} Semester`;
                
                const branchCell = document.createElement('td');
                branchCell.textContent = getBranchName(student.branch);
                
                const attendanceCell = document.createElement('td');
                
                // Calculate attendance stats with date filter
                let studentRecords = attendanceRecords.filter(record => record.studentId === student.id);
                
                if (startDate) {
                    studentRecords = studentRecords.filter(record => record.date >= startDate);
                }
                
                if (endDate) {
                    studentRecords = studentRecords.filter(record => record.date <= endDate);
                }
                
                const presentCount = studentRecords.filter(record => record.status === 'present').length;
                const totalCount = studentRecords.length;
                const percentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
                
                // Create attendance summary
                const summaryDiv = document.createElement('div');
                summaryDiv.innerHTML = `
                    <span class="attendance-percentage">${percentage}%</span>
                    <span>(${presentCount}/${totalCount} days)</span>
                    <div class="progress-bar">
                        <div class="progress" style="width: ${percentage}%"></div>
                    </div>
                `;
                
                attendanceCell.appendChild(summaryDiv);
                
                // Add detailed attendance dates
                const detailsDiv = document.createElement('div');
                detailsDiv.className = 'attendance-details';
                
                studentRecords.forEach(record => {
                    const dateSpan = document.createElement('span');
                    dateSpan.className = `attendance-date ${record.status}-date`;
                    dateSpan.textContent = record.date;
                    dateSpan.title = record.status === 'present' ? 'Present' : 'Absent';
                    detailsDiv.appendChild(dateSpan);
                });
                
                attendanceCell.appendChild(detailsDiv);
                
                const actionsCell = document.createElement('td');
                
                const viewBtn = document.createElement('button');
                viewBtn.className = 'action-btn view-btn';
                viewBtn.innerHTML = '<i class="fas fa-eye"></i> Details';
                viewBtn.onclick = () => viewStudentAttendance(student.id);
                
                actionsCell.appendChild(viewBtn);
                
                row.appendChild(idCell);
                row.appendChild(nameCell);
                row.appendChild(semesterCell);
                row.appendChild(branchCell);
                row.appendChild(attendanceCell);
                row.appendChild(actionsCell);
                
                tbody.appendChild(row);
            });
        }

        function viewStudentAttendance(studentId) {
            const student = studentDatabase.find(s => s.id === studentId);
            if (!student) return;
            
            const startDate = document.getElementById('report-start-date').value;
            const endDate = document.getElementById('report-end-date').value;
            
            let studentRecords = attendanceRecords.filter(record => record.studentId === studentId);
            
            if (startDate) {
                studentRecords = studentRecords.filter(record => record.date >= startDate);
            }
            
            if (endDate) {
                studentRecords = studentRecords.filter(record => record.date <= endDate);
            }
            
            const presentCount = studentRecords.filter(record => record.status === 'present').length;
            const totalCount = studentRecords.length;
            const percentage = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;
            
            let message = `Attendance Details for ${student.name} (${studentId})\n\n`;
            message += `Date Range: ${startDate || 'No start date'} to ${endDate || 'No end date'}\n`;
            message += `Attendance Percentage: ${percentage}%\n`;
            message += `Present: ${presentCount} days\n`;
            message += `Absent: ${totalCount - presentCount} days\n\n`;
            message += `Attendance by Date:\n`;
            
            studentRecords.forEach(record => {
                message += `${record.date}: ${record.status === 'present' ? '✅ Present' : '❌ Absent'}\n`;
            });
            
            alert(message);
        }

        function getOrdinalSuffix(number) {
            if (number === '1') return 'st';
            if (number === '2') return 'nd';
            if (number === '3') return 'rd';
            return 'th';
        }

        function getBranchName(branchCode) {
            const branches = {
                'CSE': 'Computer Science',
                'ECE': 'Electronics',
                'ME': 'Mechanical',
                'CE': 'Civil',
                'EE': 'Electrical',
                'IT': 'Information Technology'
            };
            return branches[branchCode] || branchCode;
        }

        // Attendance Dashboard Functions
        function populateStudentsList() {
            const tbody = document.getElementById('students-list');
            tbody.innerHTML = '';
            
            students.forEach(student => {
                const row = document.createElement('tr');
                
                const idCell = document.createElement('td');
                idCell.textContent = student.id;
                
                const nameCell = document.createElement('td');
                nameCell.textContent = student.name;
                
                const timerCell = document.createElement('td');
                timerCell.className = 'timer';
                timerCell.id = `timer-${student.id}`;
                timerCell.textContent = student.timer || '--:--';
                
                const statusCell = document.createElement('td');
                statusCell.className = `status-${student.status}`;
                if (student.verificationStatus === 'verifying') {
                    statusCell.className = 'status-verifying';
                    statusCell.textContent = 'Verifying...';
                } else {
                    statusCell.textContent = student.status.charAt(0).toUpperCase() + student.status.slice(1);
                }
                
                row.appendChild(idCell);
                row.appendChild(nameCell);
                row.appendChild(timerCell);
                row.appendChild(statusCell);
                
                tbody.appendChild(row);
            });
        }

        function populateManualStudentsList() {
            const tbody = document.getElementById('manual-students-list');
            tbody.innerHTML = '';
            
            students.forEach(student => {
                const row = document.createElement('tr');
                
                const idCell = document.createElement('td');
                idCell.textContent = student.id;
                
                const nameCell = document.createElement('td');
                nameCell.textContent = student.name;
                
                const statusCell = document.createElement('td');
                statusCell.className = `status-${student.status}`;
                if (student.verificationStatus === 'verifying') {
                    statusCell.className = 'status-verifying';
                    statusCell.textContent = 'Verifying...';
                } else {
                    statusCell.textContent = student.status.charAt(0).toUpperCase() + student.status.slice(1);
                }
                
                const actionCell = document.createElement('td');
                
                if (student.markedBy === 'timer' || student.verificationStatus === 'verifying') {
                    // Can't change status if marked by timer or being verified
                    actionCell.innerHTML = '<span>Auto-marked</span>';
                } else {
                    // Create action buttons
                    const actionButtons = document.createElement('div');
                    actionButtons.className = 'action-buttons';
                    
                    const presentBtn = document.createElement('button');
                    presentBtn.className = 'present-btn';
                    presentBtn.textContent = 'Present';
                    presentBtn.onclick = (e) => {
                        e.stopPropagation();
                        markStudentPresent(student.id, 'manual');
                    };
                    
                    const absentBtn = document.createElement('button');
                    absentBtn.className = 'absent-btn';
                    absentBtn.textContent = 'Absent';
                    absentBtn.onclick = (e) => {
                        e.stopPropagation();
                        markStudentAbsent(student.id);
                    };
                    
                    actionButtons.appendChild(presentBtn);
                    actionButtons.appendChild(absentBtn);
                    actionCell.appendChild(actionButtons);
                }
                
                row.appendChild(idCell);
                row.appendChild(nameCell);
                row.appendChild(statusCell);
                row.appendChild(actionCell);
                
                tbody.appendChild(row);
            });
        }

        function searchStudents() {
            const searchTerm = document.getElementById('student-search').value.toLowerCase();
            const rows = document.querySelectorAll('#manual-students-list tr');
            
            rows.forEach(row => {
                const id = row.cells[0].textContent.toLowerCase();
                const name = row.cells[1].textContent.toLowerCase();
                
                if (id.includes(searchTerm) || name.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function markStudentPresent(studentId, markedBy = 'timer') {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            // Clear any existing timer
            if (student.timerInterval) {
                clearInterval(student.timerInterval);
                student.timerInterval = null;
            }

            // Update student status
            student.status = "present";
            student.markedBy = markedBy;
            student.verificationStatus = null;
            
            // Record attendance
            const today = new Date().toISOString().split('T')[0];
            if (!attendanceRecords.some(record => record.studentId === studentId && record.date === today)) {
                attendanceRecords.push({
                    studentId,
                    date: today,
                    status: "present"
                });
            }
            
            // Update UI in both views
            updateStudentStatusUI(studentId);
        }

        function markStudentAbsent(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            // Clear any existing timer
            if (student.timerInterval) {
                clearInterval(student.timerInterval);
                student.timerInterval = null;
            }

            // Update student status
            student.status = "absent";
            student.markedBy = "manual";
            student.verificationStatus = null;
            
            // Record attendance
            const today = new Date().toISOString().split('T')[0];
            if (!attendanceRecords.some(record => record.studentId === studentId && record.date === today)) {
                attendanceRecords.push({
                    studentId,
                    date: today,
                    status: "absent"
                });
            }
            
            // Update UI in both views
            updateStudentStatusUI(studentId);
        }

        function updateStudentStatusUI(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) return;

            // Update main attendance view
            const statusCell = document.querySelector(`#students-list tr:has(td:first-child:contains('${studentId}')) td:nth-child(4)`);
            if (statusCell) {
                if (student.verificationStatus === 'verifying') {
                    statusCell.className = 'status-verifying';
                    statusCell.textContent = 'Verifying...';
                } else {
                    statusCell.className = `status-${student.status}`;
                    statusCell.textContent = student.status.charAt(0).toUpperCase() + student.status.slice(1);
                }
            }

            // Update timer display if present
            const timerCell = document.getElementById(`timer-${studentId}`);
            if (timerCell) {
                timerCell.textContent = "00:00";
            }

            // Update manual attendance view if open
            const manualStatusCell = document.querySelector(`#manual-students-list tr:has(td:first-child:contains('${studentId}')) td:nth-child(3)`);
            if (manualStatusCell) {
                if (student.verificationStatus === 'verifying') {
                    manualStatusCell.className = 'status-verifying';
                    manualStatusCell.textContent = 'Verifying...';
                } else {
                    manualStatusCell.className = `status-${student.status}`;
                    manualStatusCell.textContent = student.status.charAt(0).toUpperCase() + student.status.slice(1);
                }
                
                // Update action buttons
                const actionCell = document.querySelector(`#manual-students-list tr:has(td:first-child:contains('${studentId}')) td:nth-child(4)`);
                if (actionCell) {
                    if (student.markedBy === 'timer' || student.verificationStatus === 'verifying') {
                        actionCell.innerHTML = '<span>Auto-marked</span>';
                    } else {
                        actionCell.innerHTML = `
                            <div class="action-buttons">
                                <button class="present-btn" onclick="markStudentPresent('${studentId}', 'manual')">Present</button>
                                <button class="absent-btn" onclick="markStudentAbsent('${studentId}')">Absent</button>
                            </div>
                        `;
                    }
                }
            }
        }

        function startAttendanceSession() {
            if (isAttendanceSessionActive) {
                alert('Attendance session is already active!');
                return;
            }

            isAttendanceSessionActive = true;
            alert('Attendance session started! Students can now mark their attendance.');

            // Simulate students marking attendance at random times
            students.forEach(student => {
                // Only start timer for students not already marked
                if (student.status === 'pending') {
                    // Random delay between 1-10 seconds for demo purposes
                    const randomDelay = Math.floor(Math.random() * 9000) + 1000;
                    
                    setTimeout(() => {
                        startStudentTimer(student.id);
                    }, randomDelay);
                }
            });
        }

        function startStudentTimer(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student || student.status !== 'pending') return;

            // Update status to "marking" (not shown in UI)
            student.status = "marking";
            
            // Start timer at 5 minutes (300 seconds) for demo
            let secondsLeft = 10; // Changed to 10 seconds for demo purposes
            
            // Update timer display immediately
            const timerElement = document.getElementById(`timer-${studentId}`);
            timerElement.textContent = formatTime(secondsLeft);
            
            // Start countdown
            student.timerInterval = setInterval(() => {
                secondsLeft--;
                timerElement.textContent = formatTime(secondsLeft);
                
                if (secondsLeft <= 0) {
                    clearInterval(student.timerInterval);
                    markStudentPresent(studentId);
                }
            }, 1000);
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        // Random Ring Functions
        function showRandomRingModal() {
            if (!isAttendanceSessionActive) {
                alert('Please start an attendance session first!');
                return;
            }
            
            document.getElementById('random-ring-modal').style.display = 'flex';
        }

        function hideRandomRingModal() {
            document.getElementById('random-ring-modal').style.display = 'none';
        }

        function startRandomRing() {
            const count = parseInt(document.getElementById('random-ring-count').value);
            
            if (isNaN(count) || count < 1 || count > 10) {
                alert('Please enter a valid number between 1 and 10');
                return;
            }
            
            // Get students who are currently marking attendance (status = marking)
            const markingStudents = students.filter(student => student.status === 'marking');
            
            if (markingStudents.length === 0) {
                alert('No students are currently marking attendance');
                hideRandomRingModal();
                return;
            }
            
            // Select random students (up to the requested count)
            const selectedStudents = [];
            const shuffled = [...markingStudents].sort(() => 0.5 - Math.random());
            
            for (let i = 0; i < Math.min(count, shuffled.length); i++) {
                selectedStudents.push(shuffled[i]);
            }
            
            studentsToVerify = selectedStudents;
            currentVerificationIndex = 0;
            
            hideRandomRingModal();
            verifyNextStudent();
        }

        function verifyNextStudent() {
            if (currentVerificationIndex >= studentsToVerify.length) {
                // All students verified
                alert('Random ring verification completed!');
                return;
            }
            
            const student = studentsToVerify[currentVerificationIndex];
            
            // Update student status to verifying
            student.verificationStatus = 'verifying';
            updateStudentStatusUI(student.id);
            
            // Show verification modal
            document.getElementById('verification-student-name').textContent = student.name;
            document.getElementById('verification-student-id').textContent = `ID: ${student.id}`;
            
            // In a real app, this would show the student's face from their device camera
            document.getElementById('verification-face-image').style.display = 'none';
            document.querySelector('.verification-face-placeholder').style.display = 'block';
            
            // Start verification timer (30 seconds)
            verificationSecondsLeft = 30;
            document.getElementById('verification-timer').textContent = formatTime(verificationSecondsLeft);
            
            if (verificationTimer) {
                clearInterval(verificationTimer);
            }
            
            verificationTimer = setInterval(() => {
                verificationSecondsLeft--;
                document.getElementById('verification-timer').textContent = formatTime(verificationSecondsLeft);
                
                if (verificationSecondsLeft <= 0) {
                    clearInterval(verificationTimer);
                    verifyStudentFail();
                }
            }, 1000);
            
            document.getElementById('student-verification-modal').style.display = 'flex';
        }

        function hideStudentVerificationModal() {
            document.getElementById('student-verification-modal').style.display = 'none';
            
            if (verificationTimer) {
                clearInterval(verificationTimer);
                verificationTimer = null;
            }
        }

        function verifyStudentSuccess() {
            const student = studentsToVerify[currentVerificationIndex];
            
            // Mark student as present
            markStudentPresent(student.id, 'random-ring');
            
            // Move to next student
            currentVerificationIndex++;
            hideStudentVerificationModal();
            verifyNextStudent();
        }

        function verifyStudentFail() {
            const student = studentsToVerify[currentVerificationIndex];
            
            // Mark student as absent
            markStudentAbsent(student.id);
            
            // Move to next student
            currentVerificationIndex++;
            hideStudentVerificationModal();
            verifyNextStudent();
        }

// Global variables for session management
let activeSessions = [];
let currentSession = null;

function applyAttendanceFilters() {
    const semester = document.getElementById('attendance-semester').value;
    const branch = document.getElementById('attendance-branch').value;
    const classroom = document.getElementById('attendance-classroom').value;
    
    // Filter students based on selections
    let filteredStudents = students;
    
    if (semester) {
        filteredStudents = filteredStudents.filter(student => {
            const studentData = studentDatabase.find(s => s.id === student.id);
            return studentData && studentData.semester === semester;
        });
    }
    
    if (branch) {
        filteredStudents = filteredStudents.filter(student => {
            const studentData = studentDatabase.find(s => s.id === student.id);
            return studentData && studentData.branch === branch;
        });
    }
    
    // Update the displayed students
    populateStudentsList(filteredStudents);
}

function startAttendanceSession() {
    const classroom = document.getElementById('attendance-classroom').value;
    const semester = document.getElementById('attendance-semester').value;
    const branch = document.getElementById('attendance-branch').value;
    
    if (!classroom) {
        alert('Please select a classroom');
        return;
    }
    
    // Create new session
    currentSession = {
        id: 'SESS-' + Date.now().toString().slice(-6),
        classroom: classroom,
        semester: semester,
        branch: branch,
        startTime: new Date(),
        status: 'active',
        students: []
    };
    
    activeSessions.push(currentSession);
    
    // Update UI
    document.getElementById('start-session-btn').disabled = true;
    document.getElementById('end-session-btn').disabled = false;
    isAttendanceSessionActive = true;
    
    // Reset all student statuses
    students.forEach(student => {
        student.status = 'pending';
        student.timer = null;
        if (student.timerInterval) clearInterval(student.timerInterval);
        student.timerInterval = null;
        student.markedBy = null;
        student.verificationStatus = null;
    });
    
    populateStudentsList();
    alert(`Attendance session started for ${classroom}`);
}

function endAttendanceSession() {
    if (!currentSession) return;
    
    currentSession.endTime = new Date();
    currentSession.status = 'completed';
    
    // Save attendance records
    students.forEach(student => {
        if (student.status !== 'pending') {
            attendanceRecords.push({
                studentId: student.id,
                date: new Date().toISOString().split('T')[0],
                status: student.status,
                sessionId: currentSession.id
            });
        }
    });
    
    // Update UI
    document.getElementById('start-session-btn').disabled = false;
    document.getElementById('end-session-btn').disabled = true;
    isAttendanceSessionActive = false;
    currentSession = null;
    
    alert('Attendance session ended and records saved');
}

function showManageSessionsModal() {
    const tbody = document.getElementById('sessions-list');
    tbody.innerHTML = '';
    
    if (activeSessions.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">No active sessions</td></tr>';
    } else {
        activeSessions.forEach(session => {
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td>${session.id}</td>
                <td>${session.classroom}</td>
                <td>${session.semester || 'All'}</td>
                <td>${getBranchName(session.branch) || 'All'}</td>
                <td>${session.startTime.toLocaleTimeString()}</td>
                <td>${session.status}</td>
                <td>
                    <button class="action-btn view-btn" onclick="viewSessionDetails('${session.id}')">
                        <i class="fas fa-eye"></i> View
                    </button>
                    ${session.status === 'active' ? `
                    <button class="action-btn absent-btn" onclick="endSpecificSession('${session.id}')">
                        <i class="fas fa-stop"></i> End
                    </button>
                    ` : ''}
                </td>
            `;
            
            tbody.appendChild(row);
        });
    }
    
    document.getElementById('manage-sessions-modal').style.display = 'flex';
}

function hideManageSessionsModal() {
    document.getElementById('manage-sessions-modal').style.display = 'none';
}

function endSpecificSession(sessionId) {
    if (confirm('Are you sure you want to end this session?')) {
        const session = activeSessions.find(s => s.id === sessionId);
        if (session) {
            session.endTime = new Date();
            session.status = 'completed';
            
            // If this was the current session, update UI
            if (currentSession && currentSession.id === sessionId) {
                document.getElementById('start-session-btn').disabled = false;
                document.getElementById('end-session-btn').disabled = true;
                isAttendanceSessionActive = false;
                currentSession = null;
            }
            
            hideManageSessionsModal();
            alert('Session ended successfully');
        }
    }
}

function viewSessionDetails(sessionId) {
    const session = activeSessions.find(s => s.id === sessionId);
    if (!session) return;
    
    let message = `Session Details\n\n`;
    message += `ID: ${session.id}\n`;
    message += `Classroom: ${session.classroom}\n`;
    message += `Semester: ${session.semester || 'All'}\n`;
    message += `Branch: ${getBranchName(session.branch) || 'All'}\n`;
    message += `Start Time: ${session.startTime.toLocaleString()}\n`;
    message += `Status: ${session.status}\n`;
    
    if (session.endTime) {
        message += `End Time: ${session.endTime.toLocaleString()}\n`;
    }
    
    alert(message);
}

    </script>

<!-- Manage Sessions Modal -->
<div class="modal" id="manage-sessions-modal">
    <div class="modal-content" style="width: 700px;">
        <span class="modal-close" onclick="hideManageSessionsModal()">&times;</span>
        <h3 class="modal-title">Manage Attendance Sessions</h3>
        
        <table class="students-table">
            <thead>
                <tr>
                    <th>Session ID</th>
                    <th>Classroom</th>
                    <th>Semester</th>
                    <th>Branch</th>
                    <th>Start Time</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="sessions-list">
                <!-- Sessions will be populated here -->
            </tbody>
        </table>
    </div>
</div>

</body>
</html>